







<!DOCTYPE html>
<html>
<head>
	<title>E - Strange Relation</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="en">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<meta name="description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="E - Strange Relation" />
	<meta property="og:description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/agc048/tasks/agc048_e" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="E - Strange Relation" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/ef4bf1e/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/ef4bf1e/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/ef4bf1e/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "en";
		var userScreenName = "yamate11";
		var csrfToken = "CMKguaNU+V7pLo+RzOsW5s4aFbfsuPdihz3jfcl6cuo="
	</script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/ef4bf1e/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/ef4bf1e/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "agc048";
			var remainingText = "Remaining Time";
			var countDownText = "Contest begins in";
			var startTime = moment("2020-10-18T21:00:00+09:00");
			var endTime = moment("2020-10-18T23:30:00+09:00");
		</script>
		<style></style>
	
	
		<script type="text/x-mathjax-config">MathJax.Hub.Config({messageStyle:"none",tex2jax:{skipTags:["script","noscript","style","textarea","code"],inlineMath:[['\\(','\\)']]},delayStartupUntil:"onload"});</script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
	
	
		<link href="//img.atcoder.jp/public/ef4bf1e/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/ef4bf1e/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/ef4bf1e/js/lib/select2.min.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/ef4bf1e/css/cdn/codemirror.min.css">
		<script src="//img.atcoder.jp/public/ef4bf1e/js/cdn/codemirror.min.js"></script>
		<script src="//img.atcoder.jp/public/ef4bf1e/js/codeMirror/merged.js"></script>
	
	
		<script src="//img.atcoder.jp/public/ef4bf1e/js/cdn/run_prettify.js"></script>
	
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/ef4bf1e/js/base.js"></script>
	<script src="//img.atcoder.jp/public/ef4bf1e/js/ga.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest started</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Grand Contest 048 has begun.</p>
			</div>
			<div class="modal-footer">
				
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest is over</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Grand Contest 048 has ended.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/agc048">AtCoder Grand Contest 048</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/agc048/tasks/agc048_e?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/agc048/tasks/agc048_e?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> yamate11 (Guest) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/yamate11"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Profile</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> General Settings</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> Change Photo</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> Change Password</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> Manage Fav</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Sign Out</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fagc048%2Ftasks%2Fagc048_e">
		<input type="hidden" name="csrf_token" value="CMKguaNU&#43;V7pLo&#43;RzOsW5s4aFbfsuPdihz3jfcl6cuo=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		

<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				Contest Duration:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20201018T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2020-10-18 21:00:00+0900</time></a> ~ <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20201018T2330&p1=248' target='blank'><time class='fixtime fixtime-full'>2020-10-18 23:30:00+0900</time></a> (local time)
				(150 minutes)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">Back to Home</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/agc048"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Top</a></li>
		
			<li class="active"><a href="/contests/agc048/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Tasks</a></li>
		

		
			<li><a href="/contests/agc048/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Clarifications <span id="clar-badge" class="badge"></span></a></li>
		

		
			<li><a href="/contests/agc048/submit?taskScreenName=agc048_e"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Submit</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> Results<span class="caret"></span></a>
				<ul class="dropdown-menu">
					<li><a href="/contests/agc048/submissions"><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> All Submissions</a></li>
					
						<li><a href="/contests/agc048/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Submissions</a></li>
						<li class="divider"></li>
						<li><a href="/contests/agc048/score"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> My Score</a></li>
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/agc048/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Standings</a></li>
				
			
				
					<li><a href="/contests/agc048/standings/virtual"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Virtual Standings</a></li>
				
			
		

		
			<li><a href="/contests/agc048/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Custom Test</a></li>
		

		
			<li><a href="/contests/agc048/editorial"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Editorial</a></li>
		
		
			
			
				<li><a href="https://codeforces.com/blog/entry/83785" target="_blank" rel="noopener"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> Discuss</a></li>
			
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			E - Strange Relation
			<a class="btn btn-default btn-sm" href="/contests/agc048/tasks/agc048_e/editorial">Editorial</a>
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}
				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				var changeTimes = 0;
				if (taskLang == 'ja' || taskLang == 'en') {
					changeTimes = REMEMBER_LB;
				} else {
					var changeTimes = parseInt(taskLang, 10);
					if (isNaN(changeTimes)) {
						changeTimes = 0;
						delLS(LS_KEY);
					}
					changeTimes++;
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			Time Limit: 3 sec / Memory Limit: 1024 MB
			
		</p>

		<div id="task-statement">
			
			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>1500</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>長さ <var>N</var> の整数列 <var>A=(A_1,A_2,\cdots,A_N)</var>, および整数 <var>T</var> に対して，<var>f(A,T)</var> を，つぎのように定義します．</p>
<ul>
<li>
<p><var>f(A,T)</var> は，以下の条件をすべて満たす整数列 <var>x</var> の中で，辞書順最大のものである．
なおこの問題の制約下では，条件を満たす数列は必ず存在し，またその個数は有限であることが証明できる．よって，<var>f(A,T)</var> は必ず定義できる．</p>
<ul>
<li><var>x</var> は長さ <var>N</var> の非負整数列である．</li>
<li>各 <var>i</var> (<var>1 \leq i \leq N</var>) について，<var>y_i</var> を，<var>j&lt;i</var> かつ <var>A_j+T \times x_j &lt; A_i+T \times x_i</var> を満たす <var>j</var> の個数，と定義する．このとき，<var>y_i=x_i</var> である．</li>
</ul>
</li>
</ul>
<p>例えば，<var>A=(6,5,1),T=3</var> であるとします．
この時，条件を満たす数列 <var>x</var> として，<var>(0,0,0),(0,0,2),(0,1,0)</var> が考えられます．
よって，<var>f(A,T)</var> の値は，この中で辞書順最大の <var>(0,1,0)</var> です． </p>
<p>すぬけくんは今，<var>N</var> 個の整数列 <var>B_1,B_2,\cdots,B_N</var> と，整数 <var>T</var> を持っています．
<var>B_i</var> (<var>1 \leq i \leq N</var>) はすべて長さ <var>K</var> の整数列です．</p>
<p>これからすぬけくんは，長さ <var>N</var> の整数列 <var>A</var> を作り，<var>f(A,T)</var> を求めようとしています．
<var>A_i</var> の値は，<var>B_{i,1},B_{i,2},\cdots,B_{i,K}</var> から選ぶことにします．
ここで，<var>B_i</var> の値に重複があっても，それらの値を区別することにします．
つまり，<var>A</var> の作り方は <var>K^N</var> 通り存在します．</p>
<p>すべての <var>i</var> (<var>1 \leq i \leq N</var>) について，次の問題を解いてください．</p>
<ul>
<li><var>K^N</var> 通りすべての <var>A</var> について <var>f(A,T)</var> を求め，その <var>i</var> 項目の値を記録する．
これらの値の総和を <var>\bmod (10^9+7)</var> で求めよ．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>1 \leq N \leq 50</var></li>
<li><var>1 \leq K \leq 50</var></li>
<li><var>1 \leq T \leq 10^7</var></li>
<li><var>1 \leq B_{i,j} \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var> <var>K</var> <var>T</var>
<var>B_{1,1}</var> <var>B_{1,2}</var> <var>\cdots</var> <var>B_{1,K}</var>
<var>B_{2,1}</var> <var>B_{2,2}</var> <var>\cdots</var> <var>B_{2,K}</var>
<var>\vdots</var>
<var>B_{N,1}</var> <var>B_{N,2}</var> <var>\cdots</var> <var>B_{N,K}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>すべての <var>i</var> について，答えを一行ごとに出力せよ．</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>2 2 1
1 2
1 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>0
3
</pre>

<ul>
<li><var>A=(1,1)</var> の場合: <var>f(A,T)=(0,1)</var></li>
<li><var>A=(1,2)</var> の場合: <var>f(A,T)=(0,1)</var></li>
<li><var>A=(2,1)</var> の場合: <var>f(A,T)=(0,0)</var></li>
<li><var>A=(2,2)</var> の場合: <var>f(A,T)=(0,1)</var></li>
</ul>
<p>よって，<var>i=1</var> のときの答えは <var>0+0+0+0=0</var> であり，
<var>i=2</var> のときの答えは <var>1+1+0+1=3</var> です．</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 2 3
6 2
5 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
6
13
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>10 15 45
129 82 26 185 217 258 22 192 24 117 167 255 91 180 203
171 73 168 26 208 169 115 164 121 214 154 196 172 66 230
185 178 241 220 243 143 111 124 10 62 56 117 254 43 81
201 74 213 163 204 35 44 203 207 73 218 60 243 51 250
229 117 212 245 112 152 206 96 266 165 105 94 231 41 27
261 201 258 111 100 72 239 31 199 203 226 151 72 268 44
94 19 47 243 133 174 141 82 190 62 175 256 126 123 210
186 64 73 82 68 183 261 120 265 212 18 24 36 152 92
205 101 186 91 172 153 91 242 141 97 247 193 45 245 66
225 97 162 213 61 219 184 195 80 203 79 72 269 258 199
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0
248044096
333666695
536381826
8787512
11659012
661959013
166067001
529828166
526544756
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>1500</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>For an integer sequence of length <var>N</var>, <var>A=(A_1,A_2,\cdots,A_N)</var>, and an integer <var>T</var>, let <var>f(A,T)</var> defined as follows:</p>
<ul>
<li>
<p><var>f(A, T)</var> is the lexicographically greatest integer sequence <var>x</var> that satisfies all of the conditions below.
Here, under the constraints in this problem, it can be proved that there always are sequences that satisfy the conditions and that the number of those sequences is finite. Thus, <var>f(A, T)</var> can always be defined.</p>
<ul>
<li><var>x</var> is a sequence of length <var>N</var> consisting of non-negative integers.</li>
<li>For each <var>i</var> (<var>1 \leq i \leq N</var>), let <var>y_i</var> be the number of indices <var>j</var> such that <var>j&lt;i</var> and <var>A_j+T \times x_j &lt; A_i+T \times x_i</var>. Then, <var>y_i=x_i</var> holds.</li>
</ul>
</li>
</ul>
<p>For example, assume that <var>A=(6,5,1)</var> and <var>T=3</var>.
Then, the sequences <var>x</var> that satisfy the conditions are: <var>(0,0,0)</var>, <var>(0,0,2)</var>, and <var>(0,1,0)</var>.
Thus, the value of <var>f(A, T)</var> is the lexicographically maximum among them: <var>(0,1,0)</var>.</p>
<p>Now, Snuke has <var>N</var> integer sequences <var>B_1,B_2,\cdots,B_N</var> and an integer <var>T</var>.
Each of the sequences <var>B_i</var> (<var>1 \leq i \leq N</var>) is an integer sequence of length <var>K</var>.</p>
<p>He will create an integer sequence <var>A</var> of length <var>N</var> and compute <var>f(A, T)</var>.
The value of <var>A_i</var> will be chosen from <var>B_{i,1},B_{i,2},\cdots,B_{i,K}</var>.
Here, if <var>B_i</var> contains the same value multiple times, we will distinguish those occurrences; that is, there are <var>K^N</var> ways to create <var>A</var>.</p>
<p>For every <var>i</var> (<var>1 \leq i \leq N</var>), solve the following problem:</p>
<ul>
<li>For all <var>K^N</var> choices of <var>A</var>, we will compute <var>f(A,T)</var> and record the value of its <var>i</var>-th element.
Find the sum of these values, modulo <var>(10^9+7)</var>.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 50</var></li>
<li><var>1 \leq K \leq 50</var></li>
<li><var>1 \leq T \leq 10^7</var></li>
<li><var>1 \leq B_{i,j} \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var> <var>T</var>
<var>B_{1,1}</var> <var>B_{1,2}</var> <var>\cdots</var> <var>B_{1,K}</var>
<var>B_{2,1}</var> <var>B_{2,2}</var> <var>\cdots</var> <var>B_{2,K}</var>
<var>\vdots</var>
<var>B_{N,1}</var> <var>B_{N,2}</var> <var>\cdots</var> <var>B_{N,K}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>For every <var>i</var>, print the answer in its own line.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>2 2 1
1 2
1 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>0
3
</pre>

<ul>
<li>For <var>A=(1,1)</var>: <var>f(A,T)=(0,1)</var></li>
<li>For <var>A=(1,2)</var>: <var>f(A,T)=(0,1)</var></li>
<li>For <var>A=(2,1)</var>: <var>f(A,T)=(0,0)</var></li>
<li>For <var>A=(2,2)</var>: <var>f(A,T)=(0,1)</var></li>
</ul>
<p>Thus, the answer is <var>0+0+0+0=0</var> for <var>i=1</var> and <var>1+1+0+1=3</var> for <var>i=2</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 2 3
6 2
5 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
6
13
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>10 15 45
129 82 26 185 217 258 22 192 24 117 167 255 91 180 203
171 73 168 26 208 169 115 164 121 214 154 196 172 66 230
185 178 241 220 243 143 111 124 10 62 56 117 254 43 81
201 74 213 163 204 35 44 203 207 73 218 60 243 51 250
229 117 212 245 112 152 206 96 266 165 105 94 231 41 27
261 201 258 111 100 72 239 31 199 203 226 151 72 268 44
94 19 47 243 133 174 141 82 190 62 175 256 126 123 210
186 64 73 82 68 183 261 120 265 212 18 24 36 152 92
205 101 186 91 172 153 91 242 141 97 247 193 45 245 66
225 97 162 213 61 219 184 195 80 203 79 72 269 258 199
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
248044096
333666695
536381826
8787512
11659012
661959013
166067001
529828166
526544756
</pre></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/agc048/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="agc048_e" />
			
			<div class="form-group ">
				<label class="control-label col-sm-2" for="select-lang">Language</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="4001" data-mime="text/x-csrc">C (GCC 9.2.1)</option>
						
							<option value="4002" data-mime="text/x-csrc">C (Clang 10.0.0)</option>
						
							<option value="4003" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (GCC 9.2.1)</option>
						
							<option value="4004" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (Clang 10.0.0)</option>
						
							<option value="4005" data-mime="text/x-java">Java (OpenJDK 11.0.6)</option>
						
							<option value="4006" data-mime="text/x-python">Python (3.8.2)</option>
						
							<option value="4007" data-mime="text/x-sh">Bash (5.0.11)</option>
						
							<option value="4008" data-mime="text/x-bc">bc (1.07.1)</option>
						
							<option value="4009" data-mime="text/x-sh">Awk (GNU Awk 4.1.4)</option>
						
							<option value="4010" data-mime="text/x-csharp">C# (.NET Core 3.1.201)</option>
						
							<option value="4011" data-mime="text/x-csharp">C# (Mono-mcs 6.8.0.105)</option>
						
							<option value="4012" data-mime="text/x-csharp">C# (Mono-csc 3.5.0)</option>
						
							<option value="4013" data-mime="text/x-clojure">Clojure (1.10.1.536)</option>
						
							<option value="4014" data-mime="text/x-crystal">Crystal (0.33.0)</option>
						
							<option value="4015" data-mime="text/x-d">D (DMD 2.091.0)</option>
						
							<option value="4016" data-mime="text/x-d">D (GDC 9.2.1)</option>
						
							<option value="4017" data-mime="text/x-d">D (LDC 1.20.1)</option>
						
							<option value="4018" data-mime="application/dart">Dart (2.7.2)</option>
						
							<option value="4019" data-mime="text/x-dc">dc (1.4.1)</option>
						
							<option value="4020" data-mime="text/x-erlang">Erlang (22.3)</option>
						
							<option value="4021" data-mime="elixir">Elixir (1.10.2)</option>
						
							<option value="4022" data-mime="text/x-fsharp">F# (.NET Core 3.1.201)</option>
						
							<option value="4023" data-mime="text/x-fsharp">F# (Mono 10.2.3)</option>
						
							<option value="4024" data-mime="text/x-forth">Forth (gforth 0.7.3)</option>
						
							<option value="4025" data-mime="text/x-fortran">Fortran (GNU Fortran 9.2.1)</option>
						
							<option value="4026" data-mime="text/x-go">Go (1.14.1)</option>
						
							<option value="4027" data-mime="text/x-haskell">Haskell (GHC 8.8.3)</option>
						
							<option value="4028" data-mime="text/x-haxe">Haxe (4.0.3); js</option>
						
							<option value="4029" data-mime="text/x-haxe">Haxe (4.0.3); Java</option>
						
							<option value="4030" data-mime="text/javascript">JavaScript (Node.js 12.16.1)</option>
						
							<option value="4031" data-mime="text/x-julia">Julia (1.4.0)</option>
						
							<option value="4032" data-mime="text/x-kotlin">Kotlin (1.3.71)</option>
						
							<option value="4033" data-mime="text/x-lua">Lua (Lua 5.3.5)</option>
						
							<option value="4034" data-mime="text/x-lua">Lua (LuaJIT 2.1.0)</option>
						
							<option value="4035" data-mime="text/x-sh">Dash (0.5.8)</option>
						
							<option value="4036" data-mime="text/x-nim">Nim (1.0.6)</option>
						
							<option value="4037" data-mime="text/x-objectivec">Objective-C (Clang 10.0.0)</option>
						
							<option value="4038" data-mime="text/x-common-lisp">Common Lisp (SBCL 2.0.3)</option>
						
							<option value="4039" data-mime="text/x-ocaml">OCaml (4.10.0)</option>
						
							<option value="4040" data-mime="text/x-octave">Octave (5.2.0)</option>
						
							<option value="4041" data-mime="text/x-pascal">Pascal (FPC 3.0.4)</option>
						
							<option value="4042" data-mime="text/x-perl">Perl (5.26.1)</option>
						
							<option value="4043" data-mime="text/x-perl">Raku (Rakudo 2020.02.1)</option>
						
							<option value="4044" data-mime="text/x-php">PHP (7.4.4)</option>
						
							<option value="4045" data-mime="text/x-prolog">Prolog (SWI-Prolog 8.0.3)</option>
						
							<option value="4046" data-mime="text/x-python">PyPy2 (7.3.0)</option>
						
							<option value="4047" data-mime="text/x-python">PyPy3 (7.3.0)</option>
						
							<option value="4048" data-mime="text/x-racket">Racket (7.6)</option>
						
							<option value="4049" data-mime="text/x-ruby">Ruby (2.7.1)</option>
						
							<option value="4050" data-mime="text/x-rustsrc">Rust (1.42.0)</option>
						
							<option value="4051" data-mime="text/x-scala">Scala (2.13.1)</option>
						
							<option value="4052" data-mime="text/x-java">Java (OpenJDK 1.8.0)</option>
						
							<option value="4053" data-mime="text/x-scheme">Scheme (Gauche 0.9.9)</option>
						
							<option value="4054" data-mime="text/x-sml">Standard ML (MLton 20130715)</option>
						
							<option value="4055" data-mime="text/x-swift">Swift (5.2.1)</option>
						
							<option value="4056" data-mime="text/plain">Text (cat 8.28)</option>
						
							<option value="4057" data-mime="text/typescript">TypeScript (3.8)</option>
						
							<option value="4058" data-mime="text/x-vb">Visual Basic (.NET Core 3.1.101)</option>
						
							<option value="4059" data-mime="text/x-sh">Zsh (5.4.2)</option>
						
							<option value="4060" data-mime="text/x-cobol">COBOL - Fixed (OpenCOBOL 1.1.0)</option>
						
							<option value="4061" data-mime="text/x-cobol">COBOL - Free (OpenCOBOL 1.1.0)</option>
						
							<option value="4062" data-mime="text/x-brainfuck">Brainfuck (bf 20041219)</option>
						
							<option value="4063" data-mime="text/x-ada">Ada2012 (GNAT 9.2.1)</option>
						
							<option value="4064" data-mime="text/x-unlambda">Unlambda (2.0.0)</option>
						
							<option value="4065" data-mime="text/x-python">Cython (0.29.16)</option>
						
							<option value="4066" data-mime="text/x-sh">Sed (4.4)</option>
						
							<option value="4067" data-mime="text/x-vim">Vim (8.2.0460)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<label class="control-label col-sm-2" for="sourceCode">Source Code</label>
	<div class="col-sm-7" id="sourceCode">
		<div class="div-editor">
			<textarea class="form-control editor" name="sourceCode"></textarea>
		</div>
		<textarea class="form-control plain-textarea" style="display:none;"></textarea>
		<p>
			<span class="gray">* at most 512 KiB</span><br>
			<span class="gray">* Your source code will be saved as Main.<i>extension</i>.</span>
		</p>
	</div>
	<div class="col-sm-3 editor-buttons">
		<p><button id="btn-open-file" type="button" class="btn btn-default btn-sm">
			<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; Open File
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" aria-pressed="false" autocomplete="off">
			Toggle Editor
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" aria-pressed="false" autocomplete="off">
			Auto Height
		</button></p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>

			<input type="hidden" name="csrf_token" value="CMKguaNU&#43;V7pLo&#43;RzOsW5s4aFbfsuPdihz3jfcl6cuo=" />
			<div class="form-group">
				<label class="control-label col-sm-2" for="submit"></label>
				<div class="col-sm-5">
					<button type="submit" class="btn btn-primary" id="submit">Submit</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/agc048/tasks/agc048_e?lang=en" data-a2a-title="E - Strange Relation">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_telegram"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/agc048/rules">Rule</a></li>
					<li><a href="/contests/agc048/glossary">Glossary</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">Terms of service</a></li>
				<li><a href="/privacy">Privacy Policy</a></li>
				<li><a href="/personal">Information Protection Policy</a></li>
				<li><a href="/company">Company</a></li>
				<li><a href="/faq">FAQ</a></li>
				<li><a href="/contact">Contact</a></li>
				
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Page Top</div>

</body>
</html>

