







<!DOCTYPE html>
<html>
<head>
	<title>D - 1D Coulomb</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="ja">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-RC512FD18N"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('set', 'user_properties', {
			
				'login_status': 'logged_in',
			
		});
		gtag('config', 'G-RC512FD18N');
	</script>

	
	<meta name="description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="D - 1D Coulomb" />
	<meta property="og:description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/arc164/tasks/arc164_d" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="D - 1D Coulomb" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/bdd0457/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/bdd0457/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/bdd0457/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/bdd0457/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/bdd0457/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/bdd0457/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/bdd0457/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "ja";
		var userScreenName = "yamate11";
		var csrfToken = "xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY="
	</script>
	<script src="//img.atcoder.jp/public/bdd0457/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/bdd0457/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/bdd0457/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "arc164";
			var remainingText = "残り時間";
			var countDownText = "開始まであと";
			var startTime = moment("2023-07-09T21:00:00+09:00");
			var endTime = moment("2023-07-09T23:00:00+09:00");
		</script>
		<style></style>
	
	
		<link href="//img.atcoder.jp/public/bdd0457/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/bdd0457/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/bdd0457/js/lib/select2.min.js"></script>
	
	
		<script src="//img.atcoder.jp/public/bdd0457/js/ace/ace.js"></script>
		<script src="//img.atcoder.jp/public/bdd0457/js/ace/ext-language_tools.js"></script>
	
	
		<script src="//img.atcoder.jp/public/bdd0457/js/cdn/run_prettify.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/bdd0457/css/cdn/katex.min.css">
		<script defer src="//img.atcoder.jp/public/bdd0457/js/cdn/katex.min.js"></script>
		<script defer src="//img.atcoder.jp/public/bdd0457/js/cdn/auto-render.min.js"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
		<script>
			var katexOptions = {
				delimiters: [
					{left: "$$", right: "$$", display: true},
					
					{left: "\\(", right: "\\)", display: false},
					{left: "\\[", right: "\\]", display: true}
				],
      	ignoredTags: ["script", "noscript", "style", "textarea", "code", "option"],
				ignoredClasses: ["prettyprint", "source-code-for-copy"],
				throwOnError: false
			};
			document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, katexOptions);});
		</script>
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/bdd0457/js/base.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト開始</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 164が開始されました。</p>
			</div>
			<div class="modal-footer">
				
					<a class="btn btn-primary" href='/contests/arc164/tasks'>問題一覧ページへ移動</a>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト終了</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 164は終了しました。</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/arc164">AtCoder Regular Contest 164</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語 <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/arc164/tasks/arc164_d?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/arc164/tasks/arc164_d?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> yamate11 (Contestant) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/yamate11"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> マイプロフィール</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> 基本設定</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> アイコン設定</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> パスワードの変更</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> お気に入り管理</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> ログアウト</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc164%2Ftasks%2Farc164_d">
		<input type="hidden" name="csrf_token" value="xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		


<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				コンテスト時間:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20230709T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2023-07-09 21:00:00+0900</time></a> ~ <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20230709T2300&p1=248' target='blank'><time class='fixtime fixtime-full'>2023-07-09 23:00:00+0900</time></a> 
				(120分)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">AtCoderホームへ戻る</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/arc164"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> トップ</a></li>
		
			<li class="active"><a href="/contests/arc164/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> 問題</a></li>
		

		
			<li><a href="/contests/arc164/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> 質問 <span id="clar-badge" class="badge" ></span></a></li>
		

		
			<li><a href="/contests/arc164/submit?taskScreenName=arc164_d"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> 提出</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> 提出結果<span class="caret"></span></a>
				<ul class="dropdown-menu">
					<li><a href="/contests/arc164/submissions"><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> すべての提出</a></li>
					
						<li><a href="/contests/arc164/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> 自分の提出</a></li>
						
						
							<li class="divider"></li>
							<li><a href="/contests/arc164/score"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> 自分の得点状況</a></li>
						
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/arc164/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> 順位表</a></li>
				
			
				
					<li><a href="/contests/arc164/standings/virtual"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> バーチャル順位表</a></li>
				
			
		

		
			<li><a href="/contests/arc164/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> コードテスト</a></li>
		

		
			<li><a href="/contests/arc164/editorial"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> 解説</a></li>
		
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			D - 1D Coulomb
			<a class="btn btn-default btn-sm" href="/contests/arc164/tasks/arc164_d/editorial">解説</a>
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}

				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				function isTaskLangSet(taskLang) { return taskLang === 'ja' || taskLang === 'en';}
				if (isTaskLangSet(taskLang)) {
					const params = new URLSearchParams(window.location.search);
					if (params.get('lang')) {
						setLS(LS_KEY, REMEMBER_LB);
						taskLang = LANG;
					}
				} else {
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();

					taskLang = getLS(LS_KEY) || '';
					let changeTimes = 0;
					if (isTaskLangSet(taskLang)) {
						changeTimes = REMEMBER_LB;
					} else {
						changeTimes = parseInt(taskLang, 10);
						if (isNaN(changeTimes)) changeTimes = 0;
						changeTimes++;
					}
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			実行時間制限: 2 sec / メモリ制限: 1024 MiB
			
			
		</p>

		<div id="task-statement">
			


	
	

			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>600</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>長さ <var>2N</var> で <code>+</code> ,  <code>-</code>  が <var>N</var> 個ずつからなる文字列 <var>s</var> に対して次の問題を考え、その答えを  <var>p(s)</var> と書くことにします。</p>
<blockquote>
<p>数直線上の <var>x=1,2,3,\ldots , 2N</var> の位置に <var>2N</var> 個のボールが並んでおり、そのうち <var>N</var> 個は <var>+1</var> の、残りの <var>N</var> 個は <var>-1</var> の電荷を持ちます。ボールの持つ電荷の並び方は <var>s</var> によって表され、<var>s</var> の <var>i</var> 文字目が <code>+</code> であれば <var>x=i</var> には <var>+1</var> の電荷を持つボールが、<code>-</code> であれば <var>x=i</var> には <var>-1</var> の電荷を持つボールが配置されていることを表します。</p>
<p>それぞれのボールは、次の規則にしたがって、一斉に運動を始めます。ただし、数直線上でより小さい数が位置する方向を左、より大きい数が位置する方向を右と呼びます。</p>
<ul>
<li>各ボールに対して、各時点で <var>F</var> を次の式で定める<br>
<var>F=\lbrace</var> <var>(</var>自身より真に左に存在するボールの電荷の総和<var>)</var> <var>-</var> <var>(</var>自身より真に右に存在するボールの電荷の総和<var>)</var> <var>\rbrace</var> <var>\times</var> <var>(</var>自身の電荷<var>)</var></li>
<li>各ボールは各時点で、<var>F</var> が正であれば右に、負であれば左に、毎秒 <var>1</var> の速さで動く</li>
<li>同時に同じ座標に電荷 <var>+1</var> のボールと電荷 <var>-1</var> のボールが存在した場合、両者は打ち消しあって消滅する</li>
</ul>
<p>このとき、それぞれのボールが運動を始めてから消滅するまでに移動した距離（消滅した座標と初めの座標の差の絶対値）の総和はいくつでしょうか。</p>
</blockquote>
<p>長さ <var>2N</var> で、<code>+</code> ,  <code>-</code> ,  <code>?</code>  からなる文字列 <var>T</var> が与えられます。<var>T</var> の <code>?</code>  を  <code>+</code>  または  <code>-</code>  に置換することで得られる、 <code>+</code> ,  <code>-</code>  が <var>N</var> 個ずつからなる文字列 <var>s</var> 全てについての <var>p(s)</var> の総和を <var>998244353</var> で割った余りを求めてください。</p>
<p>なお、与えられた制約と運動の規則の下で、有限の時間内に全てのボールが消滅すること、ボールが消滅しない限り各ボールの <var>F</var> の値が <var>0</var> にならないこと、<var>3</var> つ以上のボールが同時に同じ座標に位置する瞬間が無いこと、および <var>p(s)</var> が整数になることが示せます。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>1\leq N\leq 3000</var></li>
<li><var>N</var> は整数である</li>
<li><var>|T|=2N</var></li>
<li><var>T</var> の各文字は  <code>+</code> ,  <code>-</code> ,  <code>?</code>  のいずれかであり、 <code>+</code>  と  <code>-</code>  はそれぞれ <var>N</var> 個以下である</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>T</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>答えを <var>998244353</var> で割った余りを整数で出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>2
+??-
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>6
</pre>
<p><var>T</var> から得られる文字列 <var>s</var> として、 <code>++--</code>  と  <code>+-+-</code>  が考えられます。</p>
<p><code>++--</code>  について、運動を開始した時点では各ボールの左右の電荷の総和、および <var>F</var> の値は次のようになります。</p>
<p><img src="https://img.atcoder.jp/arc164/403850a82c3adfb838197734344ae193.png"></p>
<p>したがって、<var>x=1,2</var> のボールは右に、<var>x=3,4</var> のボールは左に動き始めます。
この場合、各ボールはその後運動の向きを変えることなく、 <var>0.5</var> 秒後に <var>x=2,3</var> にあったボールが <var>x=2.5</var> で、<var>1.5</var> 秒後に <var>x=1,4</var> にあったボールが <var>x=2.5</var> でそれぞれ消滅します。
この間に、<var>x=2,3</var> にあったボールは <var>0.5</var> ずつ、<var>x=1,4</var> にあったボールは <var>1.5</var> ずつの距離を移動しているため、<var>p(</var> <code>++--</code> <var>)=4</var> です。</p>
<p>同様に観察すると <var>p(</var> <code>+-+-</code> <var>)=2</var> であることが分かるため、求める <var>p(s)</var> の総和は <var>6</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>17
??????????????????????????????????
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>285212526
</pre>
<p><var>p(s)</var> の総和を <var>998244353</var> で割った余りを出力してください。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>600</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Consider the following problem for a string <var>s</var> of length <var>2N</var> formed by <var>N</var> <code>+</code> and <var>N</var> <code>-</code>, and let <var>p(s)</var> denote the answer.</p>
<blockquote>
<p>There are <var>2N</var> balls lined up at positions <var>x=1,2,3,\ldots , 2N</var> on a number line, of which <var>N</var> have a charge of <var>+1</var> and the remaining <var>N</var> have a charge of <var>-1</var>. The arrangement of the charges of the balls is represented by <var>s</var>. If the <var>i</var>-th character of <var>s</var> is <code>+</code>, a ball with a charge of <var>+1</var> is placed at <var>x=i</var>; if it is <code>-</code>, a ball with a charge of <var>-1</var> is placed at <var>x=i</var>.</p>
<p>Each ball starts motion simultaneously according to the following rules. Here, we call the direction where smaller numbers are located on the number line "left", and the direction where larger numbers are located "right".</p>
<ul>
<li>For each ball, define <var>F</var> at each moment by the following formula:<br>
<var>F=\lbrace</var> <var>(</var>the sum of the charges of the balls strictly to the left of itself<var>)</var> <var>-</var> <var>(</var>the sum of the charges of the balls strictly to the right of itself<var>)</var> <var>\rbrace</var> <var>\times</var> <var>(</var>the charge of itself<var>)</var>.</li>
<li>At each moment, each ball moves to the right if <var>F</var> is positive, and to the left if <var>F</var> is negative, at a speed of <var>1</var> per second.</li>
<li>If a ball with a charge of <var>+1</var> and a ball with a charge of <var>-1</var> exist at the same coordinate simultaneously, they cancel out each other and disappear.</li>
</ul>
<p>Then, what is the sum of the distances moved by the balls after they start motion and before they disappear (the distance moved by a ball is the absolute difference between the coordinates where it starts and where it disappears)?</p>
</blockquote>
<p>You are given a string <var>T</var> of length <var>2N</var> consisting of <code>+</code>, <code>-</code>, and <code>?</code>. Find the sum of <var>p(s)</var> over all strings <var>s</var> formed by <var>N</var> <code>+</code> and <var>N</var> <code>-</code> that can be obtained by replacing each <code>?</code> in <var>T</var> with <code>+</code> or <code>-</code>, modulo <var>998244353</var>.</p>
<p>Under the given constraints and the rules of motion, it can be shown that all balls disappear in finite time, that the value of <var>F</var> for each ball does not become <var>0</var> until that ball disappears, that there is no moment when three or more balls are at the same coordinate simultaneously, and that <var>p(s)</var> is an integer.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1\leq N\leq 3000</var></li>
<li><var>N</var> is an integer.</li>
<li><var>|T|=2N</var></li>
<li>Each character of <var>T</var> is either <code>+</code>, <code>-</code>, or <code>?</code>, and there are at most <var>N</var> <code>+</code> and at most <var>N</var> <code>-</code>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>T</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the answer modulo <var>998244353</var>, as an integer.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>2
+??-
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>6
</pre>
<p>The strings <var>s</var> that can be obtained from <var>T</var> are <code>++--</code> and <code>+-+-</code>.</p>
<p>For <code>++--</code>, the sum of the charges of the balls to the left and right of each ball, and the value of <var>F</var> at the start of the motion are as follows:</p>
<p><img src="https://img.atcoder.jp/arc164/2f5047a41704d1c88bb2df93f67ca583.png"></p>
<p>Thus, the balls at <var>x=1,2</var> start moving to the right, and the balls at <var>x=3,4</var> start moving to the left.
Then, each ball continues to move in the same direction without changing its direction of motion, and the balls that started at <var>x=2,3</var> disappear at <var>x=2.5</var> after <var>0.5</var> seconds, and the balls that started at <var>x=1,4</var> disappear at <var>x=2.5</var> after <var>1.5</var> seconds.
During these times, the balls that started at <var>x=2,3</var> move a distance of <var>0.5</var> each, and the balls that started at <var>x=1,4</var> move a distance of <var>1.5</var> each, so <var>p(</var> <code>++--</code> <var>)=4</var>.</p>
<p>Similarly, it can be seen that <var>p(</var> <code>+-+-</code> <var>)=2</var>, so the sought sum of <var>p(s)</var> is <var>6</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>17
??????????????????????????????????
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>285212526
</pre>
<p>Be sure to print the sum of <var>p(s)</var> modulo <var>998244353</var>.</p></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/arc164/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="arc164_d" />
			
			<div class="form-group ">
				<label class="control-label col-sm-3 col-md-2" for="select-lang">言語</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="5001" data-ace-mode="c_cpp">C&#43;&#43; 20 (gcc 12.2)</option>
						
							<option value="5002" data-ace-mode="golang">Go (go 1.20.6)</option>
						
							<option value="5003" data-ace-mode="csharp">C# 11.0 (.NET 7.0.7)</option>
						
							<option value="5004" data-ace-mode="kotlin">Kotlin (Kotlin/JVM 1.8.20)</option>
						
							<option value="5005" data-ace-mode="java">Java (OpenJDK 17)</option>
						
							<option value="5006" data-ace-mode="nim">Nim (Nim 1.6.14)</option>
						
							<option value="5007" data-ace-mode="text">V (V 0.4)</option>
						
							<option value="5008" data-ace-mode="text">Zig (Zig 0.10.1)</option>
						
							<option value="5009" data-ace-mode="javascript">JavaScript (Node.js 18.16.1)</option>
						
							<option value="5010" data-ace-mode="javascript">JavaScript (Deno 1.35.1)</option>
						
							<option value="5011" data-ace-mode="r">R (GNU R 4.2.1)</option>
						
							<option value="5012" data-ace-mode="d">D (DMD 2.104.0)</option>
						
							<option value="5013" data-ace-mode="d">D (LDC 1.32.2)</option>
						
							<option value="5014" data-ace-mode="swift">Swift (swift 5.8.1)</option>
						
							<option value="5015" data-ace-mode="dart">Dart (Dart 3.0.5)</option>
						
							<option value="5016" data-ace-mode="php">PHP (php 8.2.8)</option>
						
							<option value="5017" data-ace-mode="c_cpp">C (gcc 12.2.0)</option>
						
							<option value="5018" data-ace-mode="ruby">Ruby (ruby 3.2.2)</option>
						
							<option value="5019" data-ace-mode="crystal">Crystal (Crystal 1.9.1)</option>
						
							<option value="5020" data-ace-mode="text">Brainfuck (bf 20041219)</option>
						
							<option value="5021" data-ace-mode="fsharp">F# 7.0 (.NET 7.0.7)</option>
						
							<option value="5022" data-ace-mode="julia">Julia (Julia 1.9.2)</option>
						
							<option value="5023" data-ace-mode="sh">Bash (bash 5.2.2)</option>
						
							<option value="5024" data-ace-mode="text">Text (cat 8.32)</option>
						
							<option value="5025" data-ace-mode="haskell">Haskell (GHC 9.4.5)</option>
						
							<option value="5026" data-ace-mode="fortran">Fortran (gfortran 12.2)</option>
						
							<option value="5027" data-ace-mode="lua">Lua (LuaJIT 2.1.0-beta3)</option>
						
							<option value="5028" data-ace-mode="c_cpp">C&#43;&#43; 23 (gcc 12.2)</option>
						
							<option value="5029" data-ace-mode="lisp">Common Lisp (SBCL 2.3.6)</option>
						
							<option value="5030" data-ace-mode="cobol">COBOL (Free) (GnuCOBOL 3.1.2)</option>
						
							<option value="5031" data-ace-mode="c_cpp">C&#43;&#43; 23 (Clang 16.0.6)</option>
						
							<option value="5032" data-ace-mode="sh">Zsh (Zsh 5.9)</option>
						
							<option value="5033" data-ace-mode="python">SageMath (SageMath 9.5)</option>
						
							<option value="5034" data-ace-mode="sh">Sed (GNU sed 4.8)</option>
						
							<option value="5035" data-ace-mode="text">bc (bc 1.07.1)</option>
						
							<option value="5036" data-ace-mode="text">dc (dc 1.07.1)</option>
						
							<option value="5037" data-ace-mode="perl">Perl (perl  5.34)</option>
						
							<option value="5038" data-ace-mode="sh">AWK (GNU Awk 5.0.1)</option>
						
							<option value="5039" data-ace-mode="text">なでしこ (cnako3 3.4.20)</option>
						
							<option value="5040" data-ace-mode="text">Assembly x64 (NASM 2.15.05)</option>
						
							<option value="5041" data-ace-mode="pascal">Pascal (fpc 3.2.2)</option>
						
							<option value="5042" data-ace-mode="csharp">C# 11.0 AOT (.NET 7.0.7)</option>
						
							<option value="5043" data-ace-mode="lua">Lua (Lua 5.4.6)</option>
						
							<option value="5044" data-ace-mode="prolog">Prolog (SWI-Prolog 9.0.4)</option>
						
							<option value="5045" data-ace-mode="sh">PowerShell (PowerShell 7.3.1)</option>
						
							<option value="5046" data-ace-mode="scheme">Scheme (Gauche 0.9.12)</option>
						
							<option value="5047" data-ace-mode="scala">Scala 3.3.0 (Scala Native 0.4.14)</option>
						
							<option value="5048" data-ace-mode="vbscript">Visual Basic 16.9 (.NET 7.0.7)</option>
						
							<option value="5049" data-ace-mode="text">Forth (gforth 0.7.3)</option>
						
							<option value="5050" data-ace-mode="clojure">Clojure (babashka 1.3.181)</option>
						
							<option value="5051" data-ace-mode="erlang">Erlang (Erlang 26.0.2)</option>
						
							<option value="5052" data-ace-mode="typescript">TypeScript 5.1 (Deno 1.35.1)</option>
						
							<option value="5053" data-ace-mode="c_cpp">C&#43;&#43; 17 (gcc 12.2)</option>
						
							<option value="5054" data-ace-mode="rust">Rust (rustc 1.70.0)</option>
						
							<option value="5055" data-ace-mode="python">Python (CPython 3.11.4)</option>
						
							<option value="5056" data-ace-mode="scala">Scala (Dotty 3.3.0)</option>
						
							<option value="5057" data-ace-mode="text">Koka (koka 2.4.0)</option>
						
							<option value="5058" data-ace-mode="typescript">TypeScript 5.1 (Node.js 18.16.1)</option>
						
							<option value="5059" data-ace-mode="ocaml">OCaml (ocamlopt 5.0.0)</option>
						
							<option value="5060" data-ace-mode="raku">Raku (Rakudo 2023.06)</option>
						
							<option value="5061" data-ace-mode="text">Vim (vim 9.0.0242)</option>
						
							<option value="5062" data-ace-mode="lisp">Emacs Lisp (Native Compile) (GNU Emacs 28.2)</option>
						
							<option value="5063" data-ace-mode="python">Python (Mambaforge / CPython 3.10.10)</option>
						
							<option value="5064" data-ace-mode="clojure">Clojure (clojure 1.11.1)</option>
						
							<option value="5065" data-ace-mode="text">プロデル (mono版プロデル 1.9.1182)</option>
						
							<option value="5066" data-ace-mode="text">ECLiPSe (ECLiPSe 7.1_13)</option>
						
							<option value="5067" data-ace-mode="text">Nibbles (literate form) (nibbles 1.01)</option>
						
							<option value="5068" data-ace-mode="ada">Ada (GNAT 12.2)</option>
						
							<option value="5069" data-ace-mode="text">jq (jq 1.6)</option>
						
							<option value="5070" data-ace-mode="text">Cyber (Cyber v0.2-Latest)</option>
						
							<option value="5071" data-ace-mode="clojure">Carp (Carp 0.5.5)</option>
						
							<option value="5072" data-ace-mode="c_cpp">C&#43;&#43; 17 (Clang 16.0.6)</option>
						
							<option value="5073" data-ace-mode="c_cpp">C&#43;&#43; 20 (Clang 16.0.6)</option>
						
							<option value="5074" data-ace-mode="text">LLVM IR (Clang 16.0.6)</option>
						
							<option value="5075" data-ace-mode="lisp">Emacs Lisp (Byte Compile) (GNU Emacs 28.2)</option>
						
							<option value="5076" data-ace-mode="text">Factor (Factor 0.98)</option>
						
							<option value="5077" data-ace-mode="d">D (GDC 12.2)</option>
						
							<option value="5078" data-ace-mode="python">Python (PyPy 3.10-v7.3.12)</option>
						
							<option value="5079" data-ace-mode="text">Whitespace (whitespacers 1.0.0)</option>
						
							<option value="5080" data-ace-mode="text">&gt;&lt;&gt; (fishr 0.1.0)</option>
						
							<option value="5081" data-ace-mode="ocaml">ReasonML (reason 3.9.0)</option>
						
							<option value="5082" data-ace-mode="python">Python (Cython 0.29.34)</option>
						
							<option value="5083" data-ace-mode="matlab">Octave (GNU Octave 8.2.0)</option>
						
							<option value="5084" data-ace-mode="haxe">Haxe (JVM) (Haxe 4.3.1)</option>
						
							<option value="5085" data-ace-mode="elixir">Elixir (Elixir 1.15.2)</option>
						
							<option value="5086" data-ace-mode="text">Mercury (Mercury 22.01.6)</option>
						
							<option value="5087" data-ace-mode="text">Seed7 (Seed7 3.2.1)</option>
						
							<option value="5088" data-ace-mode="lisp">Emacs Lisp (No Compile) (GNU Emacs 28.2)</option>
						
							<option value="5089" data-ace-mode="text">Unison (Unison M5b)</option>
						
							<option value="5090" data-ace-mode="cobol">COBOL (GnuCOBOL(Fixed) 3.1.2)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<div class="col-sm-3 col-md-2 editor-label">
		<label class="control-label" for="sourceCode">ソースコード</label>
		<div class="editor-buttons">
			<button id="btn-open-file" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; ファイルを開く
			</button>
			<button id="btn-customize" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> &nbsp; カスタマイズ
			</button>
			<button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" autocomplete="off">
				エディタ切り替え
			</button>
			<button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" autocomplete="off">
				高さ自動調節
			</button>
		</div>
	</div>
	<div class="col-sm-9 col-md-10" id="sourceCode">
		<div id="editor"></div>
		<textarea id="plain-textarea" class="form-control" style="display:none;" name="sourceCode"></textarea>
		<p>
			<span class="gray">※ 512 KiB まで</span><br>
		</p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>


			<input type="hidden" name="csrf_token" value="xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY=" />
			<div class="form-group">
				<label class="control-label col-sm-3 col-md-2"></label>
				<div class="col-sm-5">
					
					<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

<div class="cf-challenge" data-sitekey="0x4AAAAAAA6HJUmmLP7mLxx0" data-theme="light"></div>

					
					<button type="submit" class="btn btn-primary" id="submit">提出</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/arc164/tasks/arc164_d?lang=ja" data-a2a-title="D - 1D Coulomb">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_hatena"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/arc164/rules">ルール</a></li>
					<li><a href="/contests/arc164/glossary">用語集</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">利用規約</a></li>
				<li><a href="/privacy">プライバシーポリシー</a></li>
				<li><a href="/personal">個人情報保護方針</a></li>
				<li><a href="/company">企業情報</a></li>
				<li><a href="/faq">よくある質問</a></li>
				<li><a href="/contact">お問い合わせ</a></li>
				<li><a href="/documents/request">資料請求</a></li>
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> ページトップ</div>

</body>
</html>


