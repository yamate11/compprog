







<!DOCTYPE html>
<html>
<head>
	<title>D - 1D Coulomb</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="en">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-RC512FD18N"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-RC512FD18N');
	</script>

	
	<meta name="description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="D - 1D Coulomb" />
	<meta property="og:description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/arc164/tasks/arc164_d" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="D - 1D Coulomb" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/646bce9/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/646bce9/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/646bce9/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/646bce9/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/646bce9/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/646bce9/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/646bce9/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "en";
		var userScreenName = "yamate11";
		var csrfToken = "5ntarsw85xXmtRx1NCZEUfK3yjYGEZhG/DnCpJ5FG5E="
	</script>
	<script src="//img.atcoder.jp/public/646bce9/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/646bce9/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/646bce9/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "arc164";
			var remainingText = "Remaining Time";
			var countDownText = "Contest begins in";
			var startTime = moment("2023-07-09T21:00:00+09:00");
			var endTime = moment("2023-07-09T23:00:00+09:00");
		</script>
		<style></style>
	
	
		<link href="//img.atcoder.jp/public/646bce9/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/646bce9/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/646bce9/js/lib/select2.min.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/646bce9/css/cdn/codemirror.min.css">
		<script src="//img.atcoder.jp/public/646bce9/js/cdn/codemirror.min.js"></script>
		<script src="//img.atcoder.jp/public/646bce9/js/codeMirror/merged.js"></script>
	
	
		<script src="//img.atcoder.jp/public/646bce9/js/cdn/run_prettify.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/646bce9/css/cdn/katex.min.css">
		<script defer src="//img.atcoder.jp/public/646bce9/js/cdn/katex.min.js"></script>
		<script defer src="//img.atcoder.jp/public/646bce9/js/cdn/auto-render.min.js"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
		<script>
			var katexOptions = {
				delimiters: [
					{left: "$$", right: "$$", display: true},
					
					{left: "\\(", right: "\\)", display: false},
					{left: "\\[", right: "\\]", display: true}
				],
      	ignoredTags: ["script", "noscript", "style", "textarea", "code", "option"],
				ignoredClasses: ["prettyprint", "source-code-for-copy"],
				throwOnError: false
			};
			document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, katexOptions);});
		</script>
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/646bce9/js/base.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest started</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 164 has begun.</p>
			</div>
			<div class="modal-footer">
				
					<a class="btn btn-primary" href='/contests/arc164/tasks'>Go to the task list page</a>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest is over</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 164 has ended.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/arc164">AtCoder Regular Contest 164</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/arc164/tasks/arc164_d?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/arc164/tasks/arc164_d?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> yamate11 (Contestant) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/yamate11"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Profile</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> General Settings</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> Change Photo</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> Change Password</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> Manage Fav</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Sign Out</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc164%2Ftasks%2Farc164_d">
		<input type="hidden" name="csrf_token" value="5ntarsw85xXmtRx1NCZEUfK3yjYGEZhG/DnCpJ5FG5E=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		


<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				Contest Duration:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20230709T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2023-07-09 21:00:00+0900</time></a> - <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20230709T2300&p1=248' target='blank'><time class='fixtime fixtime-full'>2023-07-09 23:00:00+0900</time></a> (local time)
				(120 minutes)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">Back to Home</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/arc164"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Top</a></li>
		
			<li class="active"><a href="/contests/arc164/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Tasks</a></li>
		

		
			<li><a href="/contests/arc164/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Clarifications <span id="clar-badge" class="badge"></span></a></li>
		

		
			<li><a href="/contests/arc164/submit?taskScreenName=arc164_d"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Submit</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> Results<span class="caret"></span></a>
				<ul class="dropdown-menu">
					
					
						<li><a href="/contests/arc164/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Submissions</a></li>
						<li class="divider"></li>
						<li><a href="/contests/arc164/score"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> My Score</a></li>
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/arc164/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Standings</a></li>
				
			
		

		
			<li><a href="/contests/arc164/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Custom Test</a></li>
		

		
		
			
			
				<li><a href="https://codeforces.com/blog/entry/118012" target="_blank" rel="noopener"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> Discuss</a></li>
			
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			D - 1D Coulomb
			
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}
				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				var changeTimes = 0;
				if (taskLang == 'ja' || taskLang == 'en') {
					changeTimes = REMEMBER_LB;
				} else {
					var changeTimes = parseInt(taskLang, 10);
					if (isNaN(changeTimes)) {
						changeTimes = 0;
						delLS(LS_KEY);
					}
					changeTimes++;
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			Time Limit: 2 sec / Memory Limit: 1024 MB
			
		</p>

		<div id="task-statement">
			
			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>600</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>長さ <var>2N</var> で <code>+</code> ,  <code>-</code>  が <var>N</var> 個ずつからなる文字列 <var>s</var> に対して次の問題を考え、その答えを  <var>p(s)</var> と書くことにします。</p>
<blockquote>
<p>数直線上の <var>x=1,2,3,\ldots , 2N</var> の位置に <var>2N</var> 個のボールが並んでおり、そのうち <var>N</var> 個は <var>+1</var> の、残りの <var>N</var> 個は <var>-1</var> の電荷を持ちます。ボールの持つ電荷の並び方は <var>s</var> によって表され、<var>s</var> の <var>i</var> 文字目が <code>+</code> であれば <var>x=i</var> には <var>+1</var> の電荷を持つボールが、<code>-</code> であれば <var>x=i</var> には <var>-1</var> の電荷を持つボールが配置されていることを表します。</p>
<p>それぞれのボールは、次の規則にしたがって、一斉に運動を始めます。ただし、数直線上でより小さい数が位置する方向を左、より大きい数が位置する方向を右と呼びます。</p>
<ul>
<li>各ボールに対して、各時点で <var>F</var> を次の式で定める<br>
<var>F=\lbrace</var> <var>(</var>自身より真に左に存在するボールの電荷の総和<var>)</var> <var>-</var> <var>(</var>自身より真に右に存在するボールの電荷の総和<var>)</var> <var>\rbrace</var> <var>\times</var> <var>(</var>自身の電荷<var>)</var></li>
<li>各ボールは各時点で、<var>F</var> が正であれば右に、負であれば左に、毎秒 <var>1</var> の速さで動く</li>
<li>同時に同じ座標に電荷 <var>+1</var> のボールと電荷 <var>-1</var> のボールが存在した場合、両者は打ち消しあって消滅する</li>
</ul>
<p>このとき、それぞれのボールが運動を始めてから消滅するまでに移動した距離（消滅した座標と初めの座標の差の絶対値）の総和はいくつでしょうか。</p>
</blockquote>
<p>長さ <var>2N</var> で、<code>+</code> ,  <code>-</code> ,  <code>?</code>  からなる文字列 <var>T</var> が与えられます。<var>T</var> の <code>?</code>  を  <code>+</code>  または  <code>-</code>  に置換することで得られる、 <code>+</code> ,  <code>-</code>  が <var>N</var> 個ずつからなる文字列 <var>s</var> 全てについての <var>p(s)</var> の総和を <var>998244353</var> で割った余りを求めてください。</p>
<p>なお、与えられた制約と運動の規則の下で、有限の時間内に全てのボールが消滅すること、ボールが消滅しない限り各ボールの <var>F</var> の値が <var>0</var> にならないこと、<var>3</var> つ以上のボールが同時に同じ座標に位置する瞬間が無いこと、および <var>p(s)</var> が整数になることが示せます。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>1\leq N\leq 3000</var></li>
<li><var>N</var> は整数である</li>
<li><var>|T|=2N</var></li>
<li><var>T</var> の各文字は  <code>+</code> ,  <code>-</code> ,  <code>?</code>  のいずれかであり、 <code>+</code>  と  <code>-</code>  はそれぞれ <var>N</var> 個以下である</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>T</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>答えを <var>998244353</var> で割った余りを整数で出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>2
+??-
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>6
</pre>
<p><var>T</var> から得られる文字列 <var>s</var> として、 <code>++--</code>  と  <code>+-+-</code>  が考えられます。</p>
<p><code>++--</code>  について、運動を開始した時点では各ボールの左右の電荷の総和、および <var>F</var> の値は次のようになります。</p>
<p><img src="https://img.atcoder.jp/arc164/403850a82c3adfb838197734344ae193.png"></p>
<p>したがって、<var>x=1,2</var> のボールは右に、<var>x=3,4</var> のボールは左に動き始めます。
この場合、各ボールはその後運動の向きを変えることなく、 <var>0.5</var> 秒後に <var>x=2,3</var> にあったボールが <var>x=2.5</var> で、<var>1.5</var> 秒後に <var>x=1,4</var> にあったボールが <var>x=2.5</var> でそれぞれ消滅します。
この間に、<var>x=2,3</var> にあったボールは <var>0.5</var> ずつ、<var>x=1,4</var> にあったボールは <var>1.5</var> ずつの距離を移動しているため、<var>p(</var> <code>++--</code> <var>)=4</var> です。</p>
<p>同様に観察すると <var>p(</var> <code>+-+-</code> <var>)=2</var> であることが分かるため、求める <var>p(s)</var> の総和は <var>6</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>17
??????????????????????????????????
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>285212526
</pre>
<p><var>p(s)</var> の総和を <var>998244353</var> で割った余りを出力してください。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>600</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Consider the following problem for a string <var>s</var> of length <var>2N</var> formed by <var>N</var> <code>+</code> and <var>N</var> <code>-</code>, and let <var>p(s)</var> denote the answer.</p>
<blockquote>
<p>There are <var>2N</var> balls lined up at positions <var>x=1,2,3,\ldots , 2N</var> on a number line, of which <var>N</var> have a charge of <var>+1</var> and the remaining <var>N</var> have a charge of <var>-1</var>. The arrangement of the charges of the balls is represented by <var>s</var>. If the <var>i</var>-th character of <var>s</var> is <code>+</code>, a ball with a charge of <var>+1</var> is placed at <var>x=i</var>; if it is <code>-</code>, a ball with a charge of <var>-1</var> is placed at <var>x=i</var>.</p>
<p>Each ball starts motion simultaneously according to the following rules. Here, we call the direction where smaller numbers are located on the number line "left", and the direction where larger numbers are located "right".</p>
<ul>
<li>For each ball, define <var>F</var> at each moment by the following formula:<br>
<var>F=\lbrace</var> <var>(</var>the sum of the charges of the balls strictly to the left of itself<var>)</var> <var>-</var> <var>(</var>the sum of the charges of the balls strictly to the right of itself<var>)</var> <var>\rbrace</var> <var>\times</var> <var>(</var>the charge of itself<var>)</var>.</li>
<li>At each moment, each ball moves to the right if <var>F</var> is positive, and to the left if <var>F</var> is negative, at a speed of <var>1</var> per second.</li>
<li>If a ball with a charge of <var>+1</var> and a ball with a charge of <var>-1</var> exist at the same coordinate simultaneously, they cancel out each other and disappear.</li>
</ul>
<p>Then, what is the sum of the distances moved by the balls after they start motion and before they disappear (the distance moved by a ball is the absolute difference between the coordinates where it starts and where it disappears)?</p>
</blockquote>
<p>You are given a string <var>T</var> of length <var>2N</var> consisting of <code>+</code>, <code>-</code>, and <code>?</code>. Find the sum of <var>p(s)</var> over all strings <var>s</var> formed by <var>N</var> <code>+</code> and <var>N</var> <code>-</code> that can be obtained by replacing each <code>?</code> in <var>T</var> with <code>+</code> or <code>-</code>, modulo <var>998244353</var>.</p>
<p>Under the given constraints and the rules of motion, it can be shown that all balls disappear in finite time, that the value of <var>F</var> for each ball does not become <var>0</var> until that ball disappears, that there is no moment when three or more balls are at the same coordinate simultaneously, and that <var>p(s)</var> is an integer.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1\leq N\leq 3000</var></li>
<li><var>N</var> is an integer.</li>
<li><var>|T|=2N</var></li>
<li>Each character of <var>T</var> is either <code>+</code>, <code>-</code>, or <code>?</code>, and there are at most <var>N</var> <code>+</code> and at most <var>N</var> <code>-</code>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>T</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the answer modulo <var>998244353</var>, as an integer.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>2
+??-
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>6
</pre>
<p>The strings <var>s</var> that can be obtained from <var>T</var> are <code>++--</code> and <code>+-+-</code>.</p>
<p>For <code>++--</code>, the sum of the charges of the balls to the left and right of each ball, and the value of <var>F</var> at the start of the motion are as follows:</p>
<p><img src="https://img.atcoder.jp/arc164/2f5047a41704d1c88bb2df93f67ca583.png"></p>
<p>Thus, the balls at <var>x=1,2</var> start moving to the right, and the balls at <var>x=3,4</var> start moving to the left.
Then, each ball continues to move in the same direction without changing its direction of motion, and the balls that started at <var>x=2,3</var> disappear at <var>x=2.5</var> after <var>0.5</var> seconds, and the balls that started at <var>x=1,4</var> disappear at <var>x=2.5</var> after <var>1.5</var> seconds.
During these times, the balls that started at <var>x=2,3</var> move a distance of <var>0.5</var> each, and the balls that started at <var>x=1,4</var> move a distance of <var>1.5</var> each, so <var>p(</var> <code>++--</code> <var>)=4</var>.</p>
<p>Similarly, it can be seen that <var>p(</var> <code>+-+-</code> <var>)=2</var>, so the sought sum of <var>p(s)</var> is <var>6</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>17
??????????????????????????????????
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>285212526
</pre>
<p>Be sure to print the sum of <var>p(s)</var> modulo <var>998244353</var>.</p></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/arc164/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="arc164_d" />
			
			<div class="form-group ">
				<label class="control-label col-sm-2" for="select-lang">Language</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="4001" data-mime="text/x-csrc">C (GCC 9.2.1)</option>
						
							<option value="4002" data-mime="text/x-csrc">C (Clang 10.0.0)</option>
						
							<option value="4003" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (GCC 9.2.1)</option>
						
							<option value="4004" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (Clang 10.0.0)</option>
						
							<option value="4005" data-mime="text/x-java">Java (OpenJDK 11.0.6)</option>
						
							<option value="4006" data-mime="text/x-python">Python (3.8.2)</option>
						
							<option value="4007" data-mime="text/x-sh">Bash (5.0.11)</option>
						
							<option value="4008" data-mime="text/x-bc">bc (1.07.1)</option>
						
							<option value="4009" data-mime="text/x-sh">Awk (GNU Awk 4.1.4)</option>
						
							<option value="4010" data-mime="text/x-csharp">C# (.NET Core 3.1.201)</option>
						
							<option value="4011" data-mime="text/x-csharp">C# (Mono-mcs 6.8.0.105)</option>
						
							<option value="4012" data-mime="text/x-csharp">C# (Mono-csc 3.5.0)</option>
						
							<option value="4013" data-mime="text/x-clojure">Clojure (1.10.1.536)</option>
						
							<option value="4014" data-mime="text/x-crystal">Crystal (0.33.0)</option>
						
							<option value="4015" data-mime="text/x-d">D (DMD 2.091.0)</option>
						
							<option value="4016" data-mime="text/x-d">D (GDC 9.2.1)</option>
						
							<option value="4017" data-mime="text/x-d">D (LDC 1.20.1)</option>
						
							<option value="4018" data-mime="application/dart">Dart (2.7.2)</option>
						
							<option value="4019" data-mime="text/x-dc">dc (1.4.1)</option>
						
							<option value="4020" data-mime="text/x-erlang">Erlang (22.3)</option>
						
							<option value="4021" data-mime="elixir">Elixir (1.10.2)</option>
						
							<option value="4022" data-mime="text/x-fsharp">F# (.NET Core 3.1.201)</option>
						
							<option value="4023" data-mime="text/x-fsharp">F# (Mono 10.2.3)</option>
						
							<option value="4024" data-mime="text/x-forth">Forth (gforth 0.7.3)</option>
						
							<option value="4025" data-mime="text/x-fortran">Fortran (GNU Fortran 9.2.1)</option>
						
							<option value="4026" data-mime="text/x-go">Go (1.14.1)</option>
						
							<option value="4027" data-mime="text/x-haskell">Haskell (GHC 8.8.3)</option>
						
							<option value="4028" data-mime="text/x-haxe">Haxe (4.0.3); js</option>
						
							<option value="4029" data-mime="text/x-haxe">Haxe (4.0.3); Java</option>
						
							<option value="4030" data-mime="text/javascript">JavaScript (Node.js 12.16.1)</option>
						
							<option value="4031" data-mime="text/x-julia">Julia (1.4.0)</option>
						
							<option value="4032" data-mime="text/x-kotlin">Kotlin (1.3.71)</option>
						
							<option value="4033" data-mime="text/x-lua">Lua (Lua 5.3.5)</option>
						
							<option value="4034" data-mime="text/x-lua">Lua (LuaJIT 2.1.0)</option>
						
							<option value="4035" data-mime="text/x-sh">Dash (0.5.8)</option>
						
							<option value="4036" data-mime="text/x-nim">Nim (1.0.6)</option>
						
							<option value="4037" data-mime="text/x-objectivec">Objective-C (Clang 10.0.0)</option>
						
							<option value="4038" data-mime="text/x-common-lisp">Common Lisp (SBCL 2.0.3)</option>
						
							<option value="4039" data-mime="text/x-ocaml">OCaml (4.10.0)</option>
						
							<option value="4040" data-mime="text/x-octave">Octave (5.2.0)</option>
						
							<option value="4041" data-mime="text/x-pascal">Pascal (FPC 3.0.4)</option>
						
							<option value="4042" data-mime="text/x-perl">Perl (5.26.1)</option>
						
							<option value="4043" data-mime="text/x-perl">Raku (Rakudo 2020.02.1)</option>
						
							<option value="4044" data-mime="text/x-php">PHP (7.4.4)</option>
						
							<option value="4045" data-mime="text/x-prolog">Prolog (SWI-Prolog 8.0.3)</option>
						
							<option value="4046" data-mime="text/x-python">PyPy2 (7.3.0)</option>
						
							<option value="4047" data-mime="text/x-python">PyPy3 (7.3.0)</option>
						
							<option value="4048" data-mime="text/x-racket">Racket (7.6)</option>
						
							<option value="4049" data-mime="text/x-ruby">Ruby (2.7.1)</option>
						
							<option value="4050" data-mime="text/x-rustsrc">Rust (1.42.0)</option>
						
							<option value="4051" data-mime="text/x-scala">Scala (2.13.1)</option>
						
							<option value="4052" data-mime="text/x-java">Java (OpenJDK 1.8.0)</option>
						
							<option value="4053" data-mime="text/x-scheme">Scheme (Gauche 0.9.9)</option>
						
							<option value="4054" data-mime="text/x-sml">Standard ML (MLton 20130715)</option>
						
							<option value="4055" data-mime="text/x-swift">Swift (5.2.1)</option>
						
							<option value="4056" data-mime="text/plain">Text (cat 8.28)</option>
						
							<option value="4057" data-mime="text/typescript">TypeScript (3.8)</option>
						
							<option value="4058" data-mime="text/x-vb">Visual Basic (.NET Core 3.1.101)</option>
						
							<option value="4059" data-mime="text/x-sh">Zsh (5.4.2)</option>
						
							<option value="4060" data-mime="text/x-cobol">COBOL - Fixed (OpenCOBOL 1.1.0)</option>
						
							<option value="4061" data-mime="text/x-cobol">COBOL - Free (OpenCOBOL 1.1.0)</option>
						
							<option value="4062" data-mime="text/x-brainfuck">Brainfuck (bf 20041219)</option>
						
							<option value="4063" data-mime="text/x-ada">Ada2012 (GNAT 9.2.1)</option>
						
							<option value="4064" data-mime="text/x-unlambda">Unlambda (2.0.0)</option>
						
							<option value="4065" data-mime="text/x-python">Cython (0.29.16)</option>
						
							<option value="4066" data-mime="text/x-sh">Sed (4.4)</option>
						
							<option value="4067" data-mime="text/x-vim">Vim (8.2.0460)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<label class="control-label col-sm-2" for="sourceCode">Source Code</label>
	<div class="col-sm-7" id="sourceCode">
		<div class="div-editor">
			<textarea class="form-control editor" name="sourceCode"></textarea>
		</div>
		<textarea class="form-control plain-textarea" style="display:none;"></textarea>
		<p>
			<span class="gray">* at most 512 KiB</span><br>
			<span class="gray">* Your source code will be saved as Main.<i>extension</i>.</span>
		</p>
	</div>
	<div class="col-sm-3 editor-buttons">
		<p><button id="btn-open-file" type="button" class="btn btn-default btn-sm">
			<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; Open File
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" aria-pressed="false" autocomplete="off">
			Toggle Editor
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" aria-pressed="false" autocomplete="off">
			Auto Height
		</button></p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>

			<input type="hidden" name="csrf_token" value="5ntarsw85xXmtRx1NCZEUfK3yjYGEZhG/DnCpJ5FG5E=" />
			<div class="form-group">
				<label class="control-label col-sm-2" for="submit"></label>
				<div class="col-sm-5">
					<button type="submit" class="btn btn-primary" id="submit">Submit</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/arc164/tasks/arc164_d?lang=en" data-a2a-title="D - 1D Coulomb">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_telegram"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/arc164/rules">Rule</a></li>
					<li><a href="/contests/arc164/glossary">Glossary</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">Terms of service</a></li>
				<li><a href="/privacy">Privacy Policy</a></li>
				<li><a href="/personal">Information Protection Policy</a></li>
				<li><a href="/company">Company</a></li>
				<li><a href="/faq">FAQ</a></li>
				<li><a href="/contact">Contact</a></li>
				
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Page Top</div>

</body>
</html>


