





<!DOCTYPE html>

<html>
<head>
	<title>F - Sweet Alchemy</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content='en'>
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<meta name="description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.">
	<meta name="author" content="AtCoder Inc.">
	<link rel="canonical" href="https://atcoder.jp/">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="F - Sweet Alchemy" />
	<meta property="og:description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/arc096/tasks/arc096_d" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="F - Sweet Alchemy" />

	<link href='//fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href='/public/css/bootstrap.min.css?v=201904042212'>
	<link rel="stylesheet" type="text/css" href='/public/css/base.css?v=201904042212'>
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src='/public/js/lib/jquery-1.9.1.min.js?v=201904042212'></script>
	<script src='/public/js/lib/bootstrap.min.js?v=201904042212'></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.4/js.cookie.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/ja.js"></script>
	<script>
		var LANG = "en";
		var userScreenName = "";
	</script>
	<script src='/public/js/utils.js?v=201904042212'></script>
	
	
		<script src='/public/js/contest.js?v=201904042212'></script>
		<link href='/public/css/contest.css?v=201904042212' rel="stylesheet" />
		<script>
			var contestScreenName = "arc096";
			var remainingText = "Remaining Time";
			var countDownText = "Contest begins in";
			var startTime = moment("2018-04-21T21:00:00+09:00");
			var endTime = moment("2018-04-21T22:40:00+09:00");
		</script>
		<style></style>
	
	
		<script type="text/x-mathjax-config">MathJax.Hub.Config({messageStyle:"none",tex2jax:{skipTags:["script","noscript","style","textarea","code"],inlineMath:[['\\(','\\)']]}});</script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<script src='/public/js/task.js?v=201904042212'></script>
	
	
	
	
		<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
		<link href="//cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-theme/0.1.0-beta.10/select2-bootstrap.min.css" rel="stylesheet" />
		<script src='/public/js/lib/select2.min.js?v=201904042212'></script>
	
	
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/codemirror.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/codemirror.min.js"></script>
		<script src='/public/js/codeMirror/merged.js?v=201904042212'></script>
	
	
		<script src="//cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
	
	
	
	
	
	
	
	
	
	
	<script src='/public/js/base.js?v=201904042212'></script>
	<script src='/public/js/ga.js?v=201904042212'></script>
</head>

<body>
<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest started</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 096 has begun.</p>
			</div>
			<div class="modal-footer">
				
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest is over</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Regular Contest 096 has ended.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href='/contests/arc096'>AtCoder Regular Contest 096</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/flag-lang/en.png'> English <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href='/contests/arc096/tasks/arc096_d?lang=ja'><img src='//img.atcoder.jp/assets/flag-lang/ja.png'> 日本語</a></li>
							<li><a href='/contests/arc096/tasks/arc096_d?lang=en'><img src='//img.atcoder.jp/assets/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li><a href="/register?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc096%2Ftasks%2Farc096_d">Sign Up</a></li>
						<li><a href="/login?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc096%2Ftasks%2Farc096_d">Sign In</a></li>
					
				</ul>
			</div>
		</div>
	</nav>
	<form method="POST" name="form_logout" action='/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc096%2Ftasks%2Farc096_d'>
		<input type="hidden" name="csrf_token" value='mJ&#43;JYsTSsOEcgmEKolAB8b2rMXauZKoVsW6x5L21Hxc=' />
	</form>
	<div id="main-container" class="container" style="padding-top:50px;">
		

<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">Contest Duration: <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20180421T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2018-04-21 21:00:00+0900</time></a> ~ <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20180421T2240&p1=248' target='blank'><time class='fixtime fixtime-full'>2018-04-21 22:40:00+0900</time></a> (local time)</small>
		<small class="back-to-home pull-right"><a href='/'>Back to Home</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href='/contests/arc096'><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Top</a></li>
		
			<li class="active"><a href='/contests/arc096/tasks'><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Tasks</a></li>
		

		
			<li><a href='/contests/arc096/clarifications'><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Clarifications <span id="clar-badge" class="badge"></span></a></li>
		

		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> Submissions<span class="caret"></span></a>
				<ul class="dropdown-menu">
					<li><a href='/contests/arc096/submissions'><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> All Submissions</a></li>
					
				</ul>
			</li>
		

		
			<li><a href='/contests/arc096/standings'><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Standings</a></li>
		

		

		
			<li><a href='https://img.atcoder.jp/arc096/editorial.pdf' target="_blank"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Editorial</a></li>
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">F - Sweet Alchemy</span>
		<hr/>
		<p>Time Limit: 2 sec / Memory Limit: 256 MB</p>

		<div id="task-statement">
			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>900</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>パティシエの赤木さんは、「お菓子の素」という粉のみを材料として <var>N</var> 種類のドーナツを作ることができます。これらのドーナツはドーナツ <var>1</var>、ドーナツ <var>2</var>、<var>...</var>、ドーナツ <var>N</var> と呼ばれます。ドーナツ <var>i</var> <var>(1 ≤ i ≤ N)</var> を <var>1</var> 個作るには、お菓子の素 <var>m_i</var> グラムを消費する必要があります。なお、<var>0.5</var> 個など整数でない個数のドーナツを作ることはできません。</p>
<p>これらのドーナツのレシピは、ドーナツ <var>1</var> のレシピから改変を繰り返して開発されたものです。
具体的には、ドーナツ <var>i</var> <var>(2 ≤ i ≤ N)</var> のレシピはドーナツ <var>p_i</var> <var>(1 ≤ p_i &lt; i)</var> のレシピを直接改変したものです。</p>
<p>いま、赤木さんはお菓子の素を <var>X</var> グラム持っています。これを使って、今夜のパーティーに向けて可能な限りたくさんのドーナツを作ることにしました。ただし、来客の好みは様々なので、次の条件を守ることにしました。</p>
<ul>
<li>ドーナツ <var>i</var> <var>(1 ≤ i ≤ N)</var> を作る個数を <var>c_i</var> とする。<var>2 ≤ i ≤ N</var> であるようなどの整数 <var>i</var> に対しても、<var>c_{p_i} ≤ c_i ≤ c_{p_i} + D</var> となるように作る。ここで、<var>D</var> はあらかじめ決まった値である。</li>
</ul>
<p>このとき、最大で何個のドーナツを作ることができるでしょうか？お菓子の素を使い切る必要はありません。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>2 ≤ N ≤ 50</var></li>
<li><var>1 ≤ X ≤ 10^9</var></li>
<li><var>0 ≤ D ≤ 10^9</var></li>
<li><var>1 ≤ m_i ≤ 10^9</var> <var>(1 ≤ i ≤ N)</var></li>
<li><var>1 ≤ p_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>
<li>入力中の値はすべて整数である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>X</var> <var>D</var>
<var>m_1</var>
<var>m_2</var> <var>p_2</var>
<var>:</var>
<var>m_N</var> <var>p_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>条件を守って作ることのできるドーナツの最大の個数を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 100 1
15
10 1
20 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>7
</pre>

<p><var>100</var> グラムのお菓子の素があり、赤木さんは <var>3</var> 種類のドーナツを作ることができ、守るべき条件は <var>c_1 ≤ c_2 ≤ c_1 + 1</var>、<var>c_1 ≤ c_3 ≤ c_1 + 1</var> です。ドーナツ <var>1</var> を <var>2</var> 個、ドーナツ <var>2</var> を <var>3</var> 個、ドーナツ <var>3</var> を <var>2</var> 個作るのが最適です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 100 10
15
10 1
20 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>10
</pre>

<p>入力例 1 からお菓子の素の量やドーナツのレシピそのものは変わっていませんが、最後の条件が緩くなっています。この場合、ドーナツ <var>2</var> だけを <var>10</var> 個作るのが最適です。このように、必ずしもすべての種類のドーナツを作らなくても構いません。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5 1000000000 1000000
123
159 1
111 1
135 3
147 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>7496296
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>900</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Akaki, a patissier, can make <var>N</var> kinds of doughnut using only a certain powder called "Okashi no Moto" (literally "material of pastry", simply called Moto below) as ingredient. These doughnuts are called Doughnut <var>1</var>, Doughnut <var>2</var>, <var>...,</var> Doughnut <var>N</var>. In order to make one Doughnut <var>i</var> <var>(1 ≤ i ≤ N)</var>, she needs to consume <var>m_i</var> grams of Moto. She cannot make a non-integer number of doughnuts, such as <var>0.5</var> doughnuts.</p>
<p>The recipes of these doughnuts are developed by repeated modifications from the recipe of Doughnut <var>1</var>. Specifically, the recipe of Doughnut <var>i</var> <var>(2 ≤ i ≤ N)</var> is a direct modification of the recipe of Doughnut <var>p_i</var> <var>(1 ≤ p_i &lt; i)</var>.</p>
<p>Now, she has <var>X</var> grams of Moto. She decides to make as many doughnuts as possible for a party tonight. However, since the tastes of the guests differ, she will obey the following condition:</p>
<ul>
<li>Let <var>c_i</var> be the number of Doughnut <var>i</var> <var>(1 ≤ i ≤ N)</var> that she makes. For each integer <var>i</var> such that <var>2 ≤ i ≤ N</var>, <var>c_{p_i} ≤ c_i ≤ c_{p_i} + D</var> must hold. Here, <var>D</var> is a predetermined value.</li>
</ul>
<p>At most how many doughnuts can be made here? She does not necessarily need to consume all of her Moto.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>2 ≤ N ≤ 50</var></li>
<li><var>1 ≤ X ≤ 10^9</var></li>
<li><var>0 ≤ D ≤ 10^9</var></li>
<li><var>1 ≤ m_i ≤ 10^9</var> <var>(1 ≤ i ≤ N)</var></li>
<li><var>1 ≤ p_i &lt; i</var> <var>(2 ≤ i ≤ N)</var></li>
<li>All values in input are integers.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>X</var> <var>D</var>
<var>m_1</var>
<var>m_2</var> <var>p_2</var>
<var>:</var>
<var>m_N</var> <var>p_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum number of doughnuts that can be made under the condition.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 100 1
15
10 1
20 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>7
</pre>

<p>She has <var>100</var> grams of Moto, can make three kinds of doughnuts, and the conditions that must hold are <var>c_1 ≤ c_2 ≤ c_1 + 1</var> and <var>c_1 ≤ c_3 ≤ c_1 + 1</var>. It is optimal to make two Doughnuts <var>1</var>, three Doughnuts <var>2</var> and two Doughnuts <var>3</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 100 10
15
10 1
20 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>10
</pre>

<p>The amount of Moto and the recipes of the doughnuts are not changed from Sample Input 1, but the last conditions are relaxed. In this case, it is optimal to make just ten Doughnuts <var>2</var>. As seen here, she does not necessarily need to make all kinds of doughnuts.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5 1000000000 1000000
123
159 1
111 1
135 3
147 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>7496296
</pre></section>
</div>
</span>
</span>

		</div>

		

		
	</div>
</div>


		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/arc096/tasks/arc096_d?lang=en" data-a2a-title="F - Sweet Alchemy">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_telegram"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 
<div class="container">
    <footer class="footer">
		
			<ul>
				<li><a href='/contests/arc096/rules'>Rule</a></li>
				<li><a href='/contests/arc096/glossary'>Glossary</a></li>
				
			</ul>
		
		<ul>
			<li><a href='/tos'>Terms of service</a></li>
			<li><a href='/privacy'>Privacy Policy</a></li>
			<li><a href='/personal'>Information Protection Policy</a></li>
			<li><a href='/company'>Company</a></li>
			<li><a href='/faq'>FAQ</a></li>
			<li><a href='/contact'>Contact</a></li>
			
		</ul>
    <div class="text-center">
        <small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
    </div>
    </footer>
</div>
<p id="fixed-server-timer" class='contest-timer'></p>

	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Page Top</div>

</body>
</html>


