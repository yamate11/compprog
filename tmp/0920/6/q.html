







<!DOCTYPE html>
<html>
<head>
	<title>E - Coins Respawn</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="en">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<meta name="description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="E - Coins Respawn" />
	<meta property="og:description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/abc137/tasks/abc137_e" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="E - Coins Respawn" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/2edb5ff/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/2edb5ff/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/2edb5ff/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "en";
		var userScreenName = "yamate11";
		var csrfToken = "1NMrF5xv0/R5vPex+zc7tDwItq9qWsXGbgWO9ZpR0Js="
	</script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/2edb5ff/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/2edb5ff/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "abc137";
			var remainingText = "Remaining Time";
			var countDownText = "Contest begins in";
			var startTime = moment("2019-08-10T21:00:00+09:00");
			var endTime = moment("2019-08-10T22:40:00+09:00");
		</script>
		<style></style>
	
	
		<link href="//img.atcoder.jp/public/2edb5ff/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/2edb5ff/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/2edb5ff/js/lib/select2.min.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/2edb5ff/css/cdn/codemirror.min.css">
		<script src="//img.atcoder.jp/public/2edb5ff/js/cdn/codemirror.min.js"></script>
		<script src="//img.atcoder.jp/public/2edb5ff/js/codeMirror/merged.js"></script>
	
	
		<script src="//img.atcoder.jp/public/2edb5ff/js/cdn/run_prettify.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/2edb5ff/css/cdn/katex.min.css">
		<script defer src="//img.atcoder.jp/public/2edb5ff/js/cdn/katex.min.js"></script>
		<script defer src="//img.atcoder.jp/public/2edb5ff/js/cdn/auto-render.min.js"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
		<script>
			var katexOptions = {
				delimiters: [
					{left: "$$", right: "$$", display: true},
					
					{left: "\\(", right: "\\)", display: false},
					{left: "\\[", right: "\\]", display: true}
				],
      	ignoredTags: ["script", "noscript", "style", "textarea", "code", "option"],
				ignoredClasses: ["prettyprint", "source-code-for-copy"],
				throwOnError: false
			};
			document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, katexOptions);});
		</script>
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/2edb5ff/js/base.js"></script>
	<script src="//img.atcoder.jp/public/2edb5ff/js/ga.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest started</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Beginner Contest 137 has begun.</p>
			</div>
			<div class="modal-footer">
				
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Contest is over</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Beginner Contest 137 has ended.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/abc137">AtCoder Beginner Contest 137</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/abc137/tasks/abc137_e?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/abc137/tasks/abc137_e?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> yamate11 (Guest) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/yamate11"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Profile</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> General Settings</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> Change Photo</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> Change Password</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> Manage Fav</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Sign Out</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc137%2Ftasks%2Fabc137_e">
		<input type="hidden" name="csrf_token" value="1NMrF5xv0/R5vPex&#43;zc7tDwItq9qWsXGbgWO9ZpR0Js=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		


<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				Contest Duration:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20190810T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2019-08-10 21:00:00+0900</time></a> - <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20190810T2240&p1=248' target='blank'><time class='fixtime fixtime-full'>2019-08-10 22:40:00+0900</time></a> (local time)
				(100 minutes)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">Back to Home</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/abc137"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Top</a></li>
		
			<li class="active"><a href="/contests/abc137/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Tasks</a></li>
		

		
			<li><a href="/contests/abc137/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Clarifications <span id="clar-badge" class="badge"></span></a></li>
		

		
			<li><a href="/contests/abc137/submit?taskScreenName=abc137_e"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Submit</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> Results<span class="caret"></span></a>
				<ul class="dropdown-menu">
					<li><a href="/contests/abc137/submissions"><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> All Submissions</a></li>
					
						<li><a href="/contests/abc137/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> My Submissions</a></li>
						<li class="divider"></li>
						<li><a href="/contests/abc137/score"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> My Score</a></li>
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/abc137/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Standings</a></li>
				
			
				
					<li><a href="/contests/abc137/standings/virtual"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> Virtual Standings</a></li>
				
			
		

		
			<li><a href="/contests/abc137/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Custom Test</a></li>
		

		
			<li><a href="/contests/abc137/editorial"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Editorial</a></li>
		
		
			
			
				<li><a href="https://codeforces.com/blog/entry/68998" target="_blank" rel="noopener"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> Discuss</a></li>
			
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			E - Coins Respawn
			<a class="btn btn-default btn-sm" href="/contests/abc137/tasks/abc137_e/editorial">Editorial</a>
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}
				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				var changeTimes = 0;
				if (taskLang == 'ja' || taskLang == 'en') {
					changeTimes = REMEMBER_LB;
				} else {
					var changeTimes = parseInt(taskLang, 10);
					if (isNaN(changeTimes)) {
						changeTimes = 0;
						delLS(LS_KEY);
					}
					changeTimes++;
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			Time Limit: 2 sec / Memory Limit: 1024 MB
			
		</p>

		<div id="task-statement">
			
			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>500</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>1</var> から <var>N</var> までの番号がつけられた <var>N</var> 頂点と <var>M</var> 辺からなる有向グラフがあります。
<var>i</var> 番目の辺は頂点 <var>A_i</var> から頂点 <var>B_i</var> へと向かい、この辺の上には <var>C_i</var> 枚のコインが置かれています。
また、頂点 <var>N</var> にはボタンが設置されています。</p>
<p>このグラフ上でゲームを行います。
あなたは頂点 <var>1</var> でコインを <var>0</var> 枚持ってゲームを開始し、辺をたどってコインを拾いながら頂点 <var>N</var> を目指します。
<var>1</var> 本の辺を通るには <var>1</var> 分の時間がかかり、辺を通るたびにその辺の上に置かれているすべてのコインを拾うことができます。
ゲームの世界ではよくあるように、ある辺を通ってその上のコインを拾っても、その辺を次に通る際には同じ枚数のコインが再び出現しており、それらを再び拾うことができます。</p>
<p>頂点 <var>N</var> に到着したとき、ボタンを押してゲームを終了することができます。(ボタンを押さずに移動を続けることもできます。)
ただし、ゲームを終了する際に、ゲーム開始からの経過時間を <var>T</var> 分として <var>T \times P</var> 枚のコインの支払いが要求されます。持っているコインの枚数が <var>T \times P</var> 枚未満の場合は、代わりに持っているコインをすべて支払います。</p>
<p>この支払いの後に残ったコインの枚数があなたのスコアとなります。
獲得できるスコアの最大値が存在するか判定し、存在する場合はその最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>2 \leq N \leq 2500</var></li>
<li><var>1 \leq M \leq 5000</var></li>
<li><var>1 \leq A_i, B_i \leq N</var></li>
<li><var>1 \leq C_i \leq 10^5</var></li>
<li><var>0 \leq P \leq 10^5</var></li>
<li>入力中の値はすべて整数である。</li>
<li>頂点 <var>1</var> から頂点 <var>N</var> に到達することが可能である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>M</var> <var>P</var>
<var>A_1</var> <var>B_1</var> <var>C_1</var>
<var>:</var>
<var>A_M</var> <var>B_M</var> <var>C_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>獲得できるスコアの最大値が存在する場合はその最大値を、存在しない場合は <code>-1</code> を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 3 10
1 2 20
2 3 30
1 3 45
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>35
</pre>

<p><img alt="入力例 1 で与えられるグラフの図" src="https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png" /></p>
<p>頂点 <var>1</var> から頂点 <var>3</var> に移動する方法は以下の <var>2</var> 通りです。</p>
<ul>
<li>頂点 <var>1 \rightarrow 2 \rightarrow 3</var>: 道中でコインを <var>20 + 30 = 50</var> 枚拾う。ゲーム開始から <var>2</var> 分後に頂点 <var>3</var> に着き、ボタンを押してコインを <var>2 \times 10 = 20</var> 枚支払い、<var>50 - 20 = 30</var> 枚残る。</li>
<li>頂点 <var>1 \rightarrow 3</var>: 道中でコインを <var>45</var> 枚拾う。ゲーム開始から <var>1</var> 分後に頂点 <var>3</var> に着き、ボタンを押してコインを <var>1 \times 10 = 10</var> 枚支払い、<var>45 - 10 = 35</var> 枚残る。</li>
</ul>
<p>よって、獲得できるスコアの最大値は <var>35</var> です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>2 2 10
1 2 100
2 2 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>-1
</pre>

<p><img alt="入力例 2 で与えられるグラフの図" src="https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png" /></p>
<p>頂点 <var>1</var> から伸びる辺を通ると頂点 <var>2</var> に着き、ここで頂点 <var>2</var> から自分自身へと向かう辺を <var>t</var> 回通ってからボタンを押すとスコアは <var>90 + 90t</var> となります。よってスコアは無限に高めることができ、獲得できるスコアの最大値は存在しません。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>4 5 10
1 2 1
1 4 1
3 4 1
2 2 100
3 3 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0
</pre>

<p><img alt="入力例 3 で与えられるグラフの図" src="https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png" /></p>
<p>頂点 <var>1</var> から頂点 <var>4</var> へと直接向かう辺を通ること以外に頂点 <var>1</var> から頂点 <var>4</var> に移動する方法はありません。この辺の上で <var>1</var> 枚のコインを拾いますが、ゲーム終了時に <var>10</var> 枚のコインの支払いを要求されてスコアは <var>0</var> となります。</p>
<p>なお、頂点 <var>1</var> から頂点 <var>2</var> へと向かう辺を通るとその後コインを無限に拾えますが、頂点 <var>4</var> に到達してゲームを終了することができなくなるため無意味です。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>500</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a directed graph with <var>N</var> vertices numbered <var>1</var> to <var>N</var> and <var>M</var> edges.
The <var>i</var>-th edge is directed from Vertex <var>A_i</var> to Vertex <var>B_i</var>, and there are <var>C_i</var> coins placed along that edge.
Additionally, there is a button on Vertex <var>N</var>.</p>
<p>We will play a game on this graph.
You start the game on Vertex <var>1</var> with zero coins, and head for Vertex <var>N</var> by traversing the edges while collecting coins.
It takes one minute to traverse an edge, and you can collect the coins placed along the edge each time you traverse it.
As usual in games, even if you traverse an edge once and collect the coins, the same number of coins will reappear next time you traverse that edge, which you can collect again.</p>
<p>When you reach Vertex <var>N</var>, you can end the game by pressing the button. (You can also choose to leave Vertex <var>N</var> without pressing the button and continue traveling.)
However, when you end the game, you will be asked to pay <var>T \times P</var> coins, where <var>T</var> is the number of minutes elapsed since the start of the game. If you have less than <var>T \times P</var> coins, you will have to pay all of your coins instead.</p>
<p>Your score will be the number of coins you have after this payment.
Determine if there exists a maximum value of the score that can be obtained. If the answer is yes, find that maximum value.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>2 \leq N \leq 2500</var></li>
<li><var>1 \leq M \leq 5000</var></li>
<li><var>1 \leq A_i, B_i \leq N</var></li>
<li><var>1 \leq C_i \leq 10^5</var></li>
<li><var>0 \leq P \leq 10^5</var></li>
<li>All values in input are integers.</li>
<li>Vertex <var>N</var> can be reached from Vertex <var>1</var>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var> <var>P</var>
<var>A_1</var> <var>B_1</var> <var>C_1</var>
<var>:</var>
<var>A_M</var> <var>B_M</var> <var>C_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>If there exists a maximum value of the score that can be obtained, print that maximum value; otherwise, print <code>-1</code>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 3 10
1 2 20
2 3 30
1 3 45
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>35
</pre>

<p><img alt="Figure of the graph given in Sample Input 1" src="https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png" /></p>
<p>There are two ways to travel from Vertex <var>1</var> to Vertex <var>3</var>:</p>
<ul>
<li>Vertex <var>1 \rightarrow 2 \rightarrow 3</var>: You collect <var>20 + 30 = 50</var> coins on the way. After two minutes from the start of the game, you press the button, pay <var>2 \times 10 = 20</var> coins, and you have <var>50 - 20 = 30</var> coins left.</li>
<li>Vertex <var>1 \rightarrow 2</var>: You collect <var>45</var> coins on the way. After one minute from the start of the game, you press the button, pay <var>1 \times 10 = 10</var> coins, and you have <var>45 - 10 = 35</var> coins left.</li>
</ul>
<p>Thus, the maximum score that can be obtained is <var>35</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>2 2 10
1 2 100
2 2 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>-1
</pre>

<p><img alt="Figure of the graph given in Sample Input 2" src="https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png" /></p>
<p>The edge extending from Vertex <var>1</var> takes you to Vertex <var>2</var>. If you then traverse the edge extending from Vertex <var>2</var> to itself <var>t</var> times and press the button, your score will be <var>90 + 90t</var>. Thus, you can infinitely increase your score, which means there is no maximum value of the score that can be obtained.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>4 5 10
1 2 1
1 4 1
3 4 1
2 2 100
3 3 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>

<p><img alt="Figure of the graph given in Sample Input 3" src="https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png" /></p>
<p>There is no way to travel from Vertex <var>1</var> to Vertex <var>4</var> other than traversing the edge leading from Vertex <var>1</var> to Vertex <var>4</var> directly. You will pick up one coin along this edge, but after being asked to paying <var>10</var> coins, your score will be <var>0</var>.</p>
<p>Note that you can collect an infinite number of coins if you traverse the edge leading from Vertex <var>1</var> to Vertex <var>2</var>, but this is pointless since you can no longer reach Vertex <var>4</var> and end the game.</p></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/abc137/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="abc137_e" />
			
			<div class="form-group ">
				<label class="control-label col-sm-2" for="select-lang">Language</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="4001" data-mime="text/x-csrc">C (GCC 9.2.1)</option>
						
							<option value="4002" data-mime="text/x-csrc">C (Clang 10.0.0)</option>
						
							<option value="4003" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (GCC 9.2.1)</option>
						
							<option value="4004" data-mime="text/x-c&#43;&#43;src">C&#43;&#43; (Clang 10.0.0)</option>
						
							<option value="4005" data-mime="text/x-java">Java (OpenJDK 11.0.6)</option>
						
							<option value="4006" data-mime="text/x-python">Python (3.8.2)</option>
						
							<option value="4007" data-mime="text/x-sh">Bash (5.0.11)</option>
						
							<option value="4008" data-mime="text/x-bc">bc (1.07.1)</option>
						
							<option value="4009" data-mime="text/x-sh">Awk (GNU Awk 4.1.4)</option>
						
							<option value="4010" data-mime="text/x-csharp">C# (.NET Core 3.1.201)</option>
						
							<option value="4011" data-mime="text/x-csharp">C# (Mono-mcs 6.8.0.105)</option>
						
							<option value="4012" data-mime="text/x-csharp">C# (Mono-csc 3.5.0)</option>
						
							<option value="4013" data-mime="text/x-clojure">Clojure (1.10.1.536)</option>
						
							<option value="4014" data-mime="text/x-crystal">Crystal (0.33.0)</option>
						
							<option value="4015" data-mime="text/x-d">D (DMD 2.091.0)</option>
						
							<option value="4016" data-mime="text/x-d">D (GDC 9.2.1)</option>
						
							<option value="4017" data-mime="text/x-d">D (LDC 1.20.1)</option>
						
							<option value="4018" data-mime="application/dart">Dart (2.7.2)</option>
						
							<option value="4019" data-mime="text/x-dc">dc (1.4.1)</option>
						
							<option value="4020" data-mime="text/x-erlang">Erlang (22.3)</option>
						
							<option value="4021" data-mime="elixir">Elixir (1.10.2)</option>
						
							<option value="4022" data-mime="text/x-fsharp">F# (.NET Core 3.1.201)</option>
						
							<option value="4023" data-mime="text/x-fsharp">F# (Mono 10.2.3)</option>
						
							<option value="4024" data-mime="text/x-forth">Forth (gforth 0.7.3)</option>
						
							<option value="4025" data-mime="text/x-fortran">Fortran (GNU Fortran 9.2.1)</option>
						
							<option value="4026" data-mime="text/x-go">Go (1.14.1)</option>
						
							<option value="4027" data-mime="text/x-haskell">Haskell (GHC 8.8.3)</option>
						
							<option value="4028" data-mime="text/x-haxe">Haxe (4.0.3); js</option>
						
							<option value="4029" data-mime="text/x-haxe">Haxe (4.0.3); Java</option>
						
							<option value="4030" data-mime="text/javascript">JavaScript (Node.js 12.16.1)</option>
						
							<option value="4031" data-mime="text/x-julia">Julia (1.4.0)</option>
						
							<option value="4032" data-mime="text/x-kotlin">Kotlin (1.3.71)</option>
						
							<option value="4033" data-mime="text/x-lua">Lua (Lua 5.3.5)</option>
						
							<option value="4034" data-mime="text/x-lua">Lua (LuaJIT 2.1.0)</option>
						
							<option value="4035" data-mime="text/x-sh">Dash (0.5.8)</option>
						
							<option value="4036" data-mime="text/x-nim">Nim (1.0.6)</option>
						
							<option value="4037" data-mime="text/x-objectivec">Objective-C (Clang 10.0.0)</option>
						
							<option value="4038" data-mime="text/x-common-lisp">Common Lisp (SBCL 2.0.3)</option>
						
							<option value="4039" data-mime="text/x-ocaml">OCaml (4.10.0)</option>
						
							<option value="4040" data-mime="text/x-octave">Octave (5.2.0)</option>
						
							<option value="4041" data-mime="text/x-pascal">Pascal (FPC 3.0.4)</option>
						
							<option value="4042" data-mime="text/x-perl">Perl (5.26.1)</option>
						
							<option value="4043" data-mime="text/x-perl">Raku (Rakudo 2020.02.1)</option>
						
							<option value="4044" data-mime="text/x-php">PHP (7.4.4)</option>
						
							<option value="4045" data-mime="text/x-prolog">Prolog (SWI-Prolog 8.0.3)</option>
						
							<option value="4046" data-mime="text/x-python">PyPy2 (7.3.0)</option>
						
							<option value="4047" data-mime="text/x-python">PyPy3 (7.3.0)</option>
						
							<option value="4048" data-mime="text/x-racket">Racket (7.6)</option>
						
							<option value="4049" data-mime="text/x-ruby">Ruby (2.7.1)</option>
						
							<option value="4050" data-mime="text/x-rustsrc">Rust (1.42.0)</option>
						
							<option value="4051" data-mime="text/x-scala">Scala (2.13.1)</option>
						
							<option value="4052" data-mime="text/x-java">Java (OpenJDK 1.8.0)</option>
						
							<option value="4053" data-mime="text/x-scheme">Scheme (Gauche 0.9.9)</option>
						
							<option value="4054" data-mime="text/x-sml">Standard ML (MLton 20130715)</option>
						
							<option value="4055" data-mime="text/x-swift">Swift (5.2.1)</option>
						
							<option value="4056" data-mime="text/plain">Text (cat 8.28)</option>
						
							<option value="4057" data-mime="text/typescript">TypeScript (3.8)</option>
						
							<option value="4058" data-mime="text/x-vb">Visual Basic (.NET Core 3.1.101)</option>
						
							<option value="4059" data-mime="text/x-sh">Zsh (5.4.2)</option>
						
							<option value="4060" data-mime="text/x-cobol">COBOL - Fixed (OpenCOBOL 1.1.0)</option>
						
							<option value="4061" data-mime="text/x-cobol">COBOL - Free (OpenCOBOL 1.1.0)</option>
						
							<option value="4062" data-mime="text/x-brainfuck">Brainfuck (bf 20041219)</option>
						
							<option value="4063" data-mime="text/x-ada">Ada2012 (GNAT 9.2.1)</option>
						
							<option value="4064" data-mime="text/x-unlambda">Unlambda (2.0.0)</option>
						
							<option value="4065" data-mime="text/x-python">Cython (0.29.16)</option>
						
							<option value="4066" data-mime="text/x-sh">Sed (4.4)</option>
						
							<option value="4067" data-mime="text/x-vim">Vim (8.2.0460)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<label class="control-label col-sm-2" for="sourceCode">Source Code</label>
	<div class="col-sm-7" id="sourceCode">
		<div class="div-editor">
			<textarea class="form-control editor" name="sourceCode"></textarea>
		</div>
		<textarea class="form-control plain-textarea" style="display:none;"></textarea>
		<p>
			<span class="gray">* at most 512 KiB</span><br>
			<span class="gray">* Your source code will be saved as Main.<i>extension</i>.</span>
		</p>
	</div>
	<div class="col-sm-3 editor-buttons">
		<p><button id="btn-open-file" type="button" class="btn btn-default btn-sm">
			<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; Open File
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" aria-pressed="false" autocomplete="off">
			Toggle Editor
		</button></p>
		<p><button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" aria-pressed="false" autocomplete="off">
			Auto Height
		</button></p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>

			<input type="hidden" name="csrf_token" value="1NMrF5xv0/R5vPex&#43;zc7tDwItq9qWsXGbgWO9ZpR0Js=" />
			<div class="form-group">
				<label class="control-label col-sm-2" for="submit"></label>
				<div class="col-sm-5">
					<button type="submit" class="btn btn-primary" id="submit">Submit</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/abc137/tasks/abc137_e?lang=en" data-a2a-title="E - Coins Respawn">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_telegram"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/abc137/rules">Rule</a></li>
					<li><a href="/contests/abc137/glossary">Glossary</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">Terms of service</a></li>
				<li><a href="/privacy">Privacy Policy</a></li>
				<li><a href="/personal">Information Protection Policy</a></li>
				<li><a href="/company">Company</a></li>
				<li><a href="/faq">FAQ</a></li>
				<li><a href="/contact">Contact</a></li>
				
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> Page Top</div>

</body>
</html>


