M-SOLUTIONS2020-E M's Solution
2020/07/25
解けず
前計算, 割当

座標平面上の点(X_i, Y_i)に人口P_iの集落がある．i=1,..,N.
X軸，Y軸に直線が引いてある．K=0,..,N に対して，
座標軸に平行な直線をK本加えたとき，
「集落と直近の直線との距離 * 人口」の和の最小値を求める．

簡単な考察で，以下がわかる:
K本の直線を引くとき，集落をK選び，その集落を通る線を引けばよい．
そこで，
(a) 線を通す集落の部分集合を選び，
(b) そのうちX軸に平行な直線を持つ部分集合を選ぶ
この選び方の各場合の値を，(a)の数のところに登録していけば良い．
選び方は，3^N 通り．
各選び方に対して，「集落と直近の直線との距離*人口」の和を計算すると，
この計算は O(N^2) で，全体が O(N^2 * 3^N) となり，間に合わない．
そこで，
「X軸に平行な直線がこれだけ選ばれたとき，各集落から最も近い直線までの距離」
を前計算しておく．ことで，計算量を O(N * 3^N) にすることができる．

教訓:
* 「各点で3状態ある場合の全状態 (3^N) の列挙」は，ベクトルでしないで，
  「状態A の集合を選び，残りから状態B の集合を選ぶ」と考えると，
  2重のbit探索でできるので，早い．
* 選ばれたものの個数が K であるときの最小値を 0,..,N に対して求めよ
  なら，Kごとに数えるのは愚策で，
  1..,N の全部分集合の値を求めて，Kごとに最小値を取れば良い．
  
  

