







<!DOCTYPE html>
<html>
<head>
	<title>F - Exactly K Steps 2</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="ja">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-RC512FD18N"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('set', 'user_properties', {
			
				'login_status': 'logged_in',
			
		});
		gtag('config', 'G-RC512FD18N');
	</script>

	
	<meta name="description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="F - Exactly K Steps 2" />
	<meta property="og:description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/abc445/tasks/abc445_f" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="F - Exactly K Steps 2" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/8c9b94e/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/8c9b94e/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/8c9b94e/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/8c9b94e/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/8c9b94e/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/8c9b94e/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/8c9b94e/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "ja";
		var userScreenName = "yamate11";
		var csrfToken = "xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY="
	</script>
	<script src="//img.atcoder.jp/public/8c9b94e/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/8c9b94e/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/8c9b94e/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "abc445";
			var remainingText = "残り時間";
			var countDownText = "開始まであと";
			var startTime = moment("2026-02-14T21:00:00+09:00");
			var endTime = moment("2026-02-14T22:40:00+09:00");
		</script>
		<style>/* ===== AHF announce block ===== */
.ahf-announce{
  --fg:#1f2937;
  --muted:#6b7280;
  --bg:#ffffff;
  --card:#f8fafc;
  --border:#e5e7eb;
  --accent:#2563eb;
  --accent-2:#0ea5e9;

  color: var(--fg);
  background: var(--bg);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue",
               Arial, "Noto Sans JP", "Hiragino Kaku Gothic ProN",
               "Yu Gothic", Meiryo, sans-serif;
  line-height: 1.75;
  max-width: 860px;
  margin: 0 auto;
  padding: 20px 18px;
}

/* title */
.ahf-announce h3{
  margin: 0 0 12px;
  font-size: clamp(20px, 2.2vw, 26px);
  line-height: 1.35;
  font-weight: 800;
  letter-spacing: .02em;
  padding-left: 12px;
  border-left: 6px solid var(--accent);
}

/* paragraphs */
.ahf-announce p{
  margin: 10px 0;
  font-size: 15.5px;
}
.ahf-announce strong{
  font-weight: 800;
}

/* links */
.ahf-announce a{
  color: var(--accent);
  text-decoration: none;
  font-weight: 700;
}
.ahf-announce a:hover{
  text-decoration: underline;
}

/* info list (date/place/fee) */
.ahf-announce ul{
  list-style: none;
  padding: 0;
  margin: 14px 0 16px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
}
.ahf-announce li{
  padding: 10px 12px;
  border-top: 1px solid var(--border);
  display: flex;
  gap: 10px;
}
.ahf-announce li:first-child{
  border-top: none;
}
.ahf-announce li::before{
  content: "•";
  color: var(--accent-2);
  font-weight: 900;
}

/* theme highlight block */
.ahf-announce .ahf-theme{
  margin: 14px 0;
  padding: 12px 14px;
  border: 1px solid color-mix(in srgb, var(--accent) 25%, var(--border));
  background: color-mix(in srgb, var(--accent) 6%, white);
  border-radius: 12px;
}
.ahf-announce .ahf-theme strong{
  color: #0f172a;
}

/* CTA */
.ahf-announce .ahf-cta{
  margin: 16px 0 8px;
  padding: 14px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
}
.ahf-announce .ahf-cta strong{
  display: inline-block;
  margin-top: 6px;
  font-size: 16px;
}
.ahf-announce .ahf-cta a{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid color-mix(in srgb, var(--accent) 35%, var(--border));
  background: color-mix(in srgb, var(--accent) 7%, white);
}
.ahf-announce .ahf-cta a:hover{
  background: color-mix(in srgb, var(--accent) 12%, white);
}

/* small note */
.ahf-announce small{
  display: inline-block;
  color: var(--muted);
  font-size: 13px;
  line-height: 1.6;
}

/* past event */
.ahf-announce .ahf-past{
  margin-top: 14px;
  padding-top: 12px;
  border-top: 1px dashed var(--border);
  color: var(--muted);
}

/* ===== speakers (final) ===== */
.ahf-announce .ahf-speakers{
  margin: 4px 0 8px;
  padding: 0;
  border: none;
  background: transparent;
  display: block;
  text-align: left;
}
.ahf-announce .ahf-speaker-name{
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 15.5px;
  font-weight: 800;
  line-height: 1.4;
  margin: 0 0 2px;
}
.ahf-announce .ahf-speaker-comment{
  display: block;
  margin: 0 0 0 1.6em;
  font-size: 14.5px;
  color: var(--muted);
  line-height: 1.6;
}
.ahf-announce .ahf-speaker-comment::before{
  content: "— ";
  opacity: 0.5;
}
.ahf-announce .ahf-speaker-name img{
  display: inline-block;
  vertical-align: middle;
}

/* responsive tweaks */
@media (max-width: 520px){
  .ahf-announce{
    padding: 16px 12px;
  }
  .ahf-announce li{
    flex-direction: column;
    gap: 2px;
  }
  .ahf-announce .ahf-speaker-comment{
    margin-left: 1.2em;
  }
}</style>
	
	
		<link href="//img.atcoder.jp/public/8c9b94e/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/8c9b94e/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/8c9b94e/js/lib/select2.min.js"></script>
	
	
		<script src="//img.atcoder.jp/public/8c9b94e/js/ace/ace.js"></script>
		<script src="//img.atcoder.jp/public/8c9b94e/js/ace/ext-language_tools.js"></script>
	
	
		<script src="//img.atcoder.jp/public/8c9b94e/js/cdn/run_prettify.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/8c9b94e/css/cdn/katex.min.css">
		<script defer src="//img.atcoder.jp/public/8c9b94e/js/cdn/katex.min.js"></script>
		<script defer src="//img.atcoder.jp/public/8c9b94e/js/cdn/auto-render.min.js"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
		<script>
			var katexOptions = {
				delimiters: [
					{left: "$$", right: "$$", display: true},
					
					{left: "\\(", right: "\\)", display: false},
					{left: "\\[", right: "\\]", display: true}
				],
      	ignoredTags: ["script", "noscript", "style", "textarea", "code", "option"],
				ignoredClasses: ["prettyprint", "source-code-for-copy"],
				throwOnError: false
			};
			document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, katexOptions);});
		</script>
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/8c9b94e/js/base.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト開始</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Beginner Contest 445が開始されました。</p>
			</div>
			<div class="modal-footer">
				
					<a class="btn btn-primary" href='/contests/abc445/tasks'>問題一覧ページへ移動</a>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト終了</h4>
			</div>
			<div class="modal-body">
				<p>AtCoder Beginner Contest 445は終了しました。</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/abc445">AtCoder Beginner Contest 445</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語 <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/abc445/tasks/abc445_f?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/abc445/tasks/abc445_f?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> yamate11 (Contestant) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/yamate11"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> マイプロフィール</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> 基本設定</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> アイコン設定</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> パスワードの変更</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> お気に入り管理</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> ログアウト</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc445%2Ftasks%2Fabc445_f">
		<input type="hidden" name="csrf_token" value="xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		


<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				コンテスト時間:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20260214T2100&p1=248' target='blank'><time class='fixtime fixtime-full'>2026-02-14 21:00:00+0900</time></a> ~ <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20260214T2240&p1=248' target='blank'><time class='fixtime fixtime-full'>2026-02-14 22:40:00+0900</time></a> 
				(100分)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">AtCoderホームへ戻る</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/abc445"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> トップ</a></li>
		
			<li class="active"><a href="/contests/abc445/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> 問題</a></li>
		

		
			<li><a href="/contests/abc445/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> 質問 <span id="clar-badge" class="badge" ></span></a></li>
		

		
			<li><a href="/contests/abc445/submit?taskScreenName=abc445_f"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> 提出</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> 提出結果<span class="caret"></span></a>
				<ul class="dropdown-menu">
					
					
						<li><a href="/contests/abc445/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> 自分の提出</a></li>
						
						
							<li class="divider"></li>
							<li><a href="/contests/abc445/score"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> 自分の得点状況</a></li>
						
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/abc445/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> 順位表</a></li>
				
			
		

		
			<li><a href="/contests/abc445/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> コードテスト</a></li>
		

		
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			F - Exactly K Steps 2
			
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}

				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				function isTaskLangSet(taskLang) { return taskLang === 'ja' || taskLang === 'en';}
				if (isTaskLangSet(taskLang)) {
					const params = new URLSearchParams(window.location.search);
					if (params.get('lang')) {
						setLS(LS_KEY, REMEMBER_LB);
						taskLang = LANG;
					}
				} else {
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();

					taskLang = getLS(LS_KEY) || '';
					let changeTimes = 0;
					if (isTaskLangSet(taskLang)) {
						changeTimes = REMEMBER_LB;
					} else {
						changeTimes = parseInt(taskLang, 10);
						if (isNaN(changeTimes)) changeTimes = 0;
						changeTimes++;
					}
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			実行時間制限: 2 sec / メモリ制限: 1024 MiB
			
			
		</p>

		<div id="task-statement">
			

	<div class="alert alert-warning alert-dismissible fade in">
		<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<p>2026/02/14 22:40:00 まで、問題の内容・感想・解法などをSNS上に投稿することは<a href="/contests/abc445/rules" target="_blank">ルール</a>に違反する行為です。</p>
		<p>どのような投稿がルールに違反するかはこちらの<a href="/posts/262" target="_blank">記事</a>もお読みください。</p>
	</div>




	<div class="alert alert-warning alert-dismissible fade in">
		<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<p class="marked_warn_text">このコンテストでは、生成AIの使用を禁止しております。詳しくは以下のルールをご確認ください。

&lt;a href=&#34;https://info.atcoder.jp/entry/llm-rules-ja&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34; class=&#34;alert-link&#34;&gt;AtCoder生成AI対策ルール - 20251003版&lt;/a&gt;

詳しくは&lt;a href=&#34;https://atcoder.jp/posts/1567&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34; class=&#34;alert-link&#34;&gt;こちらの記事&lt;/a&gt;をご覧ください。</p>
	</div>
	<script src="//img.atcoder.jp/public/8c9b94e/js/lib/marked.js"></script>
	<script>
		$(function() {
			$(".marked_warn_text").each(function() {
				$(this).html(marked($(this).text()));
			});
		})
	</script>

			<span class="lang">
<span class="lang-ja">
<p>配点 : <var>500</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>頂点 <var>1,</var> 頂点 <var>2,\ldots,</var> 頂点 <var>N</var> の <var>N</var> 頂点からなる有向グラフがあります。
<var>1</var> 以上 <var>N</var> 以下の任意の整数の <var>2</var> つ組 <var>(i,j)</var> について、頂点 <var>i</var> から頂点 <var>j</var> への有向辺がちょうど <var>1</var> 本存在し、そのコストは <var>C _ {i,j}</var> です。</p>
<p>正整数 <var>K</var> が与えられます。
<var>s=1,2,\ldots,N</var> のそれぞれについて、以下の問題を解いてください。</p>
<ul>
<li>頂点 <var>s</var> から出発し、辺に沿って移動することを <var>K</var> 回繰り返して頂点 <var>s</var> へ向かう方法のうち、通った辺のコストの総和としてありうる最小値を求めよ。厳密には、<var>v _ 0=v _ K=s</var> を満たす <var>1</var> 以上 <var>N</var> 以下の整数からなる長さ <var>K+1</var> の列 <var>v=(v _ 0,v _ 1,\ldots,v _ K)</var> に対する <var>\displaystyle\sum _ {i=1} ^ {K}C _ {v _ {i-1},v _ i}</var> の総和としてありうる最小値を求めよ。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>1\le N\le100</var></li>
<li><var>1\le K\le10 ^ 9</var></li>
<li><var>0\le C _ {i,j}\le10 ^ 9\ (1\le i\le N,1\le j\le N)</var></li>
<li>入力はすべて整数</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>K</var>
<var>C _ {1,1}</var> <var>C _ {1,2}</var> <var>\ldots</var> <var>C _ {1,N}</var>
<var>C _ {2,1}</var> <var>C _ {2,2}</var> <var>\ldots</var> <var>C _ {2,N}</var>
<var>\vdots</var>
<var>C _ {N,1}</var> <var>C _ {N,2}</var> <var>\ldots</var> <var>C _ {N,N}</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>N</var> 行にわたって出力せよ。
<var>i</var> 行目 <var>(1\le i\le N)</var> には <var>s=i</var> に対する問題の答えを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4 3
3 1 4 1
5 9 2 6
5 3 5 8
9 7 9 3
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>8
8
8
9
</pre>
<p><var>s=1</var> のとき、<var>1\rightarrow2\rightarrow3\rightarrow1</var> と移動すると、通った辺のコストの総和は <var>1+2+5=8</var> となります。
頂点 <var>1</var> からスタートして <var>3</var> 回辺に沿って移動し、通った辺のコストの総和を <var>7</var> 以下にすることはできないため、<var>1</var> 行目には <code>8</code> を出力してください。</p>
<p><var>s=4</var> のとき、<var>4\rightarrow4\rightarrow4\rightarrow4</var> と移動すると、通った辺のコストの総和は <var>3+3+3=9</var> となります。
同じ辺や同じ頂点を複数回通ってもよいことと、同じ辺を複数回通った場合は通った回数だけ総和にその辺のコストが足されることに注意してください。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 1000000000
100 999 999
999 100 999
999 999 100
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>100000000000
100000000000
100000000000
</pre>
<p>答えが <var>2 ^ {32}</var> 以上になる場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>10 9482
748 169 586 329 972 529 432 519 408 587
138 249 656 114 632 299 984 755 404 772
155 506 832 854 353 465 387 374 567 385
631 556 951 428 104 705 530 406 258 102
709 325 334 193 520 798 749 582 337 910
530 110 659 635 786 773 811 468 810 638
111 822 554 627 395 959 924 698 777 893
142 848 532 781 711 814 665 395 960 290
746 266 603 553 893 353 323 640 172 263
749 921 845 334 594 821 233 695 109 951
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>1382481
1382481
1382628
1382481
1382481
1382540
1382481
1382739
1382499
1382481
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>500</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a directed graph with <var>N</var> vertices, vertex <var>1,</var> vertex <var>2,\ldots,</var> vertex <var>N</var>.
For any pair of integers <var>(i,j)</var> with <var>1 \leq i,j \leq N</var>, there is exactly one directed edge from vertex <var>i</var> to vertex <var>j</var> with cost <var>C_{i,j}</var>.</p>
<p>You are given a positive integer <var>K</var>.
For each of <var>s=1,2,\ldots,N</var>, solve the following problem.</p>
<ul>
<li>Among the ways to start at vertex <var>s</var>, move along an edge <var>K</var> times, and return to vertex <var>s</var>, find the minimum possible total cost of the edges traversed. More formally, find the minimum possible value of <var>\displaystyle\sum_{i=1}^{K}C_{v_{i-1},v_i}</var> for a sequence <var>v=(v_0,v_1,\ldots,v_K)</var> of integers between <var>1</var> and <var>N</var>, inclusive, of length <var>K+1</var> satisfying <var>v_0=v_K=s</var>.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \le N \le 100</var></li>
<li><var>1 \le K \le 10^9</var></li>
<li><var>0 \le C_{i,j} \le 10^9\ (1 \le i \le N,1 \le j \le N)</var></li>
<li>All input values are integers.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var>
<var>C_{1,1}</var> <var>C_{1,2}</var> <var>\ldots</var> <var>C_{1,N}</var>
<var>C_{2,1}</var> <var>C_{2,2}</var> <var>\ldots</var> <var>C_{2,N}</var>
<var>\vdots</var>
<var>C_{N,1}</var> <var>C_{N,2}</var> <var>\ldots</var> <var>C_{N,N}</var>
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Output <var>N</var> lines.
The <var>i</var>-th line <var>(1 \le i \le N)</var> should contain the answer to the problem for <var>s=i</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4 3
3 1 4 1
5 9 2 6
5 3 5 8
9 7 9 3
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>8
8
8
9
</pre>
<p>For <var>s=1</var>, moving <var>1\rightarrow2\rightarrow3\rightarrow1</var> gives a total cost of <var>1+2+5=8</var>.
It is impossible to start at vertex <var>1</var>, move along an edge three times, and achieve a total cost of <var>7</var> or less, so print <code>8</code> on the first line.</p>
<p>For <var>s=4</var>, moving <var>4\rightarrow4\rightarrow4\rightarrow4</var> gives a total cost of <var>3+3+3=9</var>.
Note that the same edge or the same vertex may be traversed multiple times, and if the same edge is traversed multiple times, its cost is added to the total that many times.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 1000000000
100 999 999
999 100 999
999 999 100
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>100000000000
100000000000
100000000000
</pre>
<p>The answer may be <var>2^{32}</var> or greater.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>10 9482
748 169 586 329 972 529 432 519 408 587
138 249 656 114 632 299 984 755 404 772
155 506 832 854 353 465 387 374 567 385
631 556 951 428 104 705 530 406 258 102
709 325 334 193 520 798 749 582 337 910
530 110 659 635 786 773 811 468 810 638
111 822 554 627 395 959 924 698 777 893
142 848 532 781 711 814 665 395 960 290
746 266 603 553 893 353 323 640 172 263
749 921 845 334 594 821 233 695 109 951
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>1382481
1382481
1382628
1382481
1382481
1382540
1382481
1382739
1382499
1382481
</pre></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/abc445/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="abc445_f" />
			
			<div class="form-group ">
				<label class="control-label col-sm-3 col-md-2" for="select-lang">言語</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="6001" data-ace-mode="text">&gt;&lt;&gt; (fishr 0.1.0)</option>
						
							<option value="6002" data-ace-mode="ada">Ada 2022 (GNAT 15.2.0)</option>
						
							<option value="6003" data-ace-mode="text">APL (GNU APL 1.9)</option>
						
							<option value="6004" data-ace-mode="mips">Assembly MIPS O32 ABI (GNU assembler 2.42)</option>
						
							<option value="6005" data-ace-mode="assembly_x86">Assembly x64 (NASM 2.16.03)</option>
						
							<option value="6006" data-ace-mode="text">AWK (GNU awk 5.2.1)</option>
						
							<option value="6007" data-ace-mode="text">A言語 (interpreter af48a2a)</option>
						
							<option value="6008" data-ace-mode="sh">Bash (bash 5.3)</option>
						
							<option value="6009" data-ace-mode="basic">BASIC (FreeBASIC 1.10.1)</option>
						
							<option value="6010" data-ace-mode="text">bc (GNU bc 1.08.2)</option>
						
							<option value="6011" data-ace-mode="text">Befunge93 (TBC 1.0)</option>
						
							<option value="6012" data-ace-mode="text">Brainfuck (Tritium 1.2.73)</option>
						
							<option value="6013" data-ace-mode="c_cpp">C23 (Clang 21.1.0)</option>
						
							<option value="6014" data-ace-mode="c_cpp">C23 (GCC 14.2.0)</option>
						
							<option value="6015" data-ace-mode="csharp">C# 13.0 (.NET 9.0.8)</option>
						
							<option value="6016" data-ace-mode="csharp">C# 13.0 (.NET Native AOT 9.0.8)</option>
						
							<option value="6017" data-ace-mode="c_cpp">C&#43;&#43;23 (GCC 15.2.0)</option>
						
							<option value="6018" data-ace-mode="text">C3 (c3c 0.7.5)</option>
						
							<option value="6019" data-ace-mode="text">Carp(Carp 0.5.5)</option>
						
							<option value="6020" data-ace-mode="c_cpp">cLay (cLay 20250308-1 (GCC 15.2.0))</option>
						
							<option value="6021" data-ace-mode="clojure">Clojure (babashka 1.12.208)</option>
						
							<option value="6022" data-ace-mode="clojure">Clojure (clojure 1.12.2)</option>
						
							<option value="6023" data-ace-mode="clojure">Clojure (Clojure AOT 1.12.2)</option>
						
							<option value="6025" data-ace-mode="clojure">Clojure (ClojureScript 1.12.42 (Clojure 1.12.2 Node.js 22.19.0))</option>
						
							<option value="6026" data-ace-mode="cobol">COBOL (Free) (GnuCOBOL 3.2)</option>
						
							<option value="6027" data-ace-mode="lisp">Common Lisp (SBCL 2.5.8)</option>
						
							<option value="6028" data-ace-mode="crystal">Crystal (Crystal 1.17.0)</option>
						
							<option value="6029" data-ace-mode="text">Cyber (Cyber v0.3)</option>
						
							<option value="6030" data-ace-mode="d">D (DMD 2.111.0)</option>
						
							<option value="6031" data-ace-mode="d">D (GDC 15.2)</option>
						
							<option value="6032" data-ace-mode="d">D (LDC 1.41.0)</option>
						
							<option value="6033" data-ace-mode="dart">Dart (Dart 3.9.2)</option>
						
							<option value="6034" data-ace-mode="text">dc 1.5.2 (GNU bc 1.08.2)</option>
						
							<option value="6035" data-ace-mode="prolog">ECLiPSe (ECLiPSe 7.1_13)</option>
						
							<option value="6036" data-ace-mode="eiffel">Eiffel (Gobo Eiffel 22.01)</option>
						
							<option value="6037" data-ace-mode="eiffel">Eiffel (Liberty Eiffel 07829e3)</option>
						
							<option value="6038" data-ace-mode="elixir">Elixir (Elixir 1.18.4 (OTP 28.0.2))</option>
						
							<option value="6039" data-ace-mode="lisp">Emacs Lisp(Native Compile)(GNU Emacs 29.4)</option>
						
							<option value="6040" data-ace-mode="text">Emojicode 1.0 beta 2 (emojicodec 1.0 beta 2)</option>
						
							<option value="6041" data-ace-mode="erlang">Erlang (Erlang 28.0.2)</option>
						
							<option value="6042" data-ace-mode="fsharp">F# 9.0 (.NET 9.0.8)</option>
						
							<option value="6043" data-ace-mode="text">Factor (Factor 0.100)</option>
						
							<option value="6044" data-ace-mode="sh">Fish (fish 4.0.2)</option>
						
							<option value="6045" data-ace-mode="forth">Forth (gforth 0.7.3)</option>
						
							<option value="6046" data-ace-mode="fortran">Fortran2018 (Flang 20.1.7)</option>
						
							<option value="6047" data-ace-mode="fortran">Fortran2023 (GCC 14.2.0)</option>
						
							<option value="6048" data-ace-mode="fortran">FORTRAN77 (GCC 14.2.0)</option>
						
							<option value="6049" data-ace-mode="text">Gleam (Gleam 1.12.0 (OTP 28.0.2))</option>
						
							<option value="6050" data-ace-mode="golang">Go 1.18 (gccgo 15.2.0)</option>
						
							<option value="6051" data-ace-mode="golang">Go (go 1.25.1)</option>
						
							<option value="6052" data-ace-mode="haskell">Haskell (GHC 9.8.4)</option>
						
							<option value="6053" data-ace-mode="haxe">Haxe/JVM 4.3.7 (hxjava 4.2.0)</option>
						
							<option value="6054" data-ace-mode="c_cpp">C&#43;&#43; IOI-Style(GNU&#43;&#43;20) (GCC 14.2.0)</option>
						
							<option value="6055" data-ace-mode="lisp">ISLisp (Easy-ISLisp 5.43)</option>
						
							<option value="6056" data-ace-mode="java">Java24 (OpenJDK 24.0.2)</option>
						
							<option value="6057" data-ace-mode="javascript">JavaScript (Bun 1.2.21)</option>
						
							<option value="6058" data-ace-mode="javascript">JavaScript (Deno 2.4.5)</option>
						
							<option value="6059" data-ace-mode="javascript">JavaScript (Node.js 22.19.0)</option>
						
							<option value="6060" data-ace-mode="text">Jule (jule 0.1.6)</option>
						
							<option value="6061" data-ace-mode="text">Koka (koka v3.2.2)</option>
						
							<option value="6062" data-ace-mode="kotlin">Kotlin (Kotlin/JVM 2.2.10)</option>
						
							<option value="6063" data-ace-mode="text">Kuin (kuincl v.2021.8.17)</option>
						
							<option value="6064" data-ace-mode="text">Lazy K (irori v1.0.0)</option>
						
							<option value="6065" data-ace-mode="text">Lean (lean v4.22.0)</option>
						
							<option value="6066" data-ace-mode="text">LLVM IR (Clang 21.1.0)</option>
						
							<option value="6067" data-ace-mode="lua">Lua (Lua 5.4.7)</option>
						
							<option value="6068" data-ace-mode="lua">Lua (LuaJIT 2.1.1703358377)</option>
						
							<option value="6069" data-ace-mode="text">Mercury (Mercury 22.01.8)</option>
						
							<option value="6071" data-ace-mode="nim">Nim (Nim 1.6.20)</option>
						
							<option value="6072" data-ace-mode="nim">Nim (Nim 2.2.4)</option>
						
							<option value="6073" data-ace-mode="ocaml">OCaml (ocamlopt 5.3.0)</option>
						
							<option value="6074" data-ace-mode="text">Octave (GNU Octave 10.2.0)</option>
						
							<option value="6075" data-ace-mode="pascal">Pascal (fpc 3.2.2)</option>
						
							<option value="6076" data-ace-mode="perl">Perl (perl 5.38.2)</option>
						
							<option value="6077" data-ace-mode="php">PHP (PHP 8.4.12)</option>
						
							<option value="6078" data-ace-mode="text">Piet (your-diary/piet_programming_language 3.0.0) (PPM image)</option>
						
							<option value="6079" data-ace-mode="text">Pony (ponyc 0.59.0)</option>
						
							<option value="6080" data-ace-mode="powershell">PowerShell (PowerShell 7.5.2)</option>
						
							<option value="6081" data-ace-mode="prolog">Prolog (SWI-Prolog 9.2.9)</option>
						
							<option value="6082" data-ace-mode="python">Python (CPython 3.13.7)</option>
						
							<option value="6083" data-ace-mode="python">Python (PyPy 3.11-v7.3.20)</option>
						
							<option value="6084" data-ace-mode="r">R (GNU R 4.5.0)</option>
						
							<option value="6085" data-ace-mode="text">ReasonML (reson 3.16.0)</option>
						
							<option value="6086" data-ace-mode="ruby">Ruby 3.3 (truffleruby 25.0.0)</option>
						
							<option value="6087" data-ace-mode="ruby">Ruby 3.4 (ruby 3.4.5)</option>
						
							<option value="6088" data-ace-mode="rust">Rust (rustc 1.89.0)</option>
						
							<option value="6089" data-ace-mode="python">SageMath (SageMath 10.7)</option>
						
							<option value="6090" data-ace-mode="scala">Scala (Dotty 3.7.2)</option>
						
							<option value="6091" data-ace-mode="scala">Scala 3.7.2 (Scala Native 0.5.8)</option>
						
							<option value="6092" data-ace-mode="scheme">Scheme (ChezScheme 10.2.0)</option>
						
							<option value="6093" data-ace-mode="scheme">Scheme (Gauche 0.9.15)</option>
						
							<option value="6094" data-ace-mode="text">Seed7 (Seed7 3.5.0)</option>
						
							<option value="6095" data-ace-mode="swift">Swift 6.2</option>
						
							<option value="6096" data-ace-mode="tcl">Tcl (tclsh 9.0.1)</option>
						
							<option value="6097" data-ace-mode="text">Terra (Terra 1.2.0)</option>
						
							<option value="6098" data-ace-mode="tex">TeX (tex 3.141592653)</option>
						
							<option value="6099" data-ace-mode="text">Text (cat 9.4)</option>
						
							<option value="6100" data-ace-mode="typescript">TypeScript 5.8 (Deno 2.4.5)</option>
						
							<option value="6101" data-ace-mode="typescript">TypeScript 5.9 (tsc 5.9.2 (Bun 1.2.21))</option>
						
							<option value="6102" data-ace-mode="typescript">TypeScript 5.9 (tsc 5.9.2 (Node.js 22.19.0))</option>
						
							<option value="6103" data-ace-mode="text">Uiua (uiua 0.16.2)</option>
						
							<option value="6104" data-ace-mode="text">Unison (Unison 0.5.47)</option>
						
							<option value="6105" data-ace-mode="text">V (0.4.10)</option>
						
							<option value="6106" data-ace-mode="vala">Vala (valac 0.56.18)</option>
						
							<option value="6107" data-ace-mode="verilog">Verilog 2012 (Icarus Verilog 12.0)</option>
						
							<option value="6108" data-ace-mode="text">Veryl (veryl 0.16.4)</option>
						
							<option value="6109" data-ace-mode="text">WebAssembly (wabt 1.0.34 &#43; iwasm 2.4.1)</option>
						
							<option value="6110" data-ace-mode="text">Whitespace (whitespacers 1.3.0)</option>
						
							<option value="6111" data-ace-mode="zig">Zig (Zig 0.15.1)</option>
						
							<option value="6112" data-ace-mode="text">なでしこ (cnako3 3.7.8 (Node.js 22.19.0))</option>
						
							<option value="6113" data-ace-mode="text">プロデル (mono版プロデル 2.0.1353)</option>
						
							<option value="6114" data-ace-mode="julia">Julia (Julia 1.11.6)</option>
						
							<option value="6115" data-ace-mode="python">Python (Codon 0.19.3)</option>
						
							<option value="6116" data-ace-mode="c_cpp">C&#43;&#43;23 (Clang 21.1.0)</option>
						
							<option value="6117" data-ace-mode="text">Fix (1.1.0-alpha.12)</option>
						
							<option value="6118" data-ace-mode="sql">SQL (DuckDB 1.3.2)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<div class="col-sm-3 col-md-2 editor-label">
		<label class="control-label" for="sourceCode">ソースコード</label>
		<div class="editor-buttons">
			<button id="btn-open-file" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; ファイルを開く
			</button>
			<button id="btn-customize" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> &nbsp; カスタマイズ
			</button>
			<button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" autocomplete="off">
				エディタ切り替え
			</button>
			<button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" autocomplete="off">
				高さ自動調節
			</button>
		</div>
	</div>
	<div class="col-sm-9 col-md-10" id="sourceCode">
		<div id="editor"></div>
		<textarea id="plain-textarea" class="form-control" style="display:none;" name="sourceCode"></textarea>
		<p>
			<span class="gray">※ 512 KiB まで</span><br>
		</p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>


			<input type="hidden" name="csrf_token" value="xq/2/1/cd0OKZhkOMPzGHO28HpSv5GCbMjIXdzS6eNY=" />
			<div class="form-group">
				<label class="control-label col-sm-3 col-md-2"></label>
				<div class="col-sm-5">
					
					<button type="submit" class="btn btn-primary" id="submit">提出</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/abc445/tasks/abc445_f?lang=ja" data-a2a-title="F - Exactly K Steps 2">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_hatena"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/abc445/rules">ルール</a></li>
					<li><a href="/contests/abc445/glossary">用語集</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">利用規約</a></li>
				<li><a href="/privacy">プライバシーポリシー</a></li>
				<li><a href="/personal">個人情報保護方針</a></li>
				<li><a href="/company">企業情報</a></li>
				<li><a href="/faq">よくある質問</a></li>
				<li><a href="/contact">お問い合わせ</a></li>
				<li><a href="/documents/request">資料請求</a></li>
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> ページトップ</div>

</body>
</html>


