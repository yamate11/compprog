ABC134-F Permutation Oddness
2020/03/06
解けず
箱根駅伝DP

1..n の順列 (p_i)_i で，\sum | i - p_i | = k となるものの個数を
mod 10^9+7 で求める． n <= 50, k <= n*n

DP は DP なのだが．数字 i まで見た時に，
  i 以上の数字で使った集合が S
という情報を持っていれば遷移ができるが，n <= 50 なので間に合わない．
かといって
  i 以上の数字で使ったものの数は k
では，i が使われているかどうかがわからないので，遷移ができない．
  i 未満の数字で使ったものの数は k
でも，もちろん同じ．
ところがちょっと変えるとできる．
  i 未満の数字で使ったものの数は k
で数えるのだが，列を全部別に数えるのではなく，i以上の数字が
来ているところは，全部同一視「*」扱いとして1個と数えることにする．
すると，i のところでは，今まで i-k 個あった * のどれか一つを
i に変えるというのを一様に行うことができて，遷移ができる．
n のところまで行けば * は全部無くなっているので問題ない．
あとは，
  現在までに確定している和の量が t
というのを状態に加えておけば良い．たとえば 32*6 というのがあったら，
これは3,2,6の分の確定値4の他に，*のところには5以上が来るので
確定値2, 1と4が5以上の場所に行くので確定値4+1というふうに考える．
